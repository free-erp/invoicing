
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package com.e68erp.demo.client.core;

import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Font;
import java.awt.Image;
import java.awt.Rectangle;
import java.awt.Toolkit;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.util.Collection;
import java.util.Date;
import java.util.HashMap;

import javax.imageio.ImageIO;
import javax.swing.ImageIcon;
import javax.swing.JCheckBoxMenuItem;
import javax.swing.JDialog;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JMenuBar;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.UIManager;

import com.e68erp.demo.client.forms.accounting.CBankCashDialog;
import com.e68erp.demo.client.forms.accounting.CBankCashManageWindow;
import com.e68erp.demo.client.forms.accounting.CBussinessExpenseDialog;
import com.e68erp.demo.client.forms.accounting.CBussinessExpenseManageWindow;
import com.e68erp.demo.client.forms.accounting.CCommonExpenseDialog;
import com.e68erp.demo.client.forms.accounting.CCommonExpenseManageWindow;
import com.e68erp.demo.client.forms.accounting.COtherIncomeDialog;
import com.e68erp.demo.client.forms.accounting.COtherIncomeManageWindow;
import com.e68erp.demo.client.forms.accounting.CPayableClearingDialog;
import com.e68erp.demo.client.forms.accounting.CPayableClearingManageWindow;
import com.e68erp.demo.client.forms.accounting.CPrePayableDialog;
import com.e68erp.demo.client.forms.accounting.CPrePayableManageWindow;
import com.e68erp.demo.client.forms.accounting.CPreReceivableDialog;
import com.e68erp.demo.client.forms.accounting.CPreReceivableManageWindow;
import com.e68erp.demo.client.forms.accounting.CReceivableClearingDialog;
import com.e68erp.demo.client.forms.accounting.CReceivableClearingManageWindow;
import com.e68erp.demo.client.forms.basic.CCustomerManageWindow;
import com.e68erp.demo.client.forms.basic.CEmployeeManageWindow;
import com.e68erp.demo.client.forms.basic.CProductManageWindow;
import com.e68erp.demo.client.forms.basic.CStorageManageWindow;
import com.e68erp.demo.client.forms.basic.CSubjectManageWindow;
import com.e68erp.demo.client.forms.basic.ProductSelectPanel;
import com.e68erp.demo.client.forms.help.CAboutDialog;
import com.e68erp.demo.client.forms.purchase.CChoosepurchaseOrderChangeDialog;
import com.e68erp.demo.client.forms.purchase.CPurchaseChangeOrderWindow;
import com.e68erp.demo.client.forms.purchase.CPurchaseIndentDialog;
import com.e68erp.demo.client.forms.purchase.CPurchaseIndentWindow;
import com.e68erp.demo.client.forms.purchase.CPurchaseOrderBackDialog;
import com.e68erp.demo.client.forms.purchase.CPurchaseOrderBackWindow;
import com.e68erp.demo.client.forms.purchase.CPurchaseOrderDialog;
import com.e68erp.demo.client.forms.purchase.CPurchaseOrderWindow;
import com.e68erp.demo.client.forms.sale.CSaleChangeMoneyDialog;
import com.e68erp.demo.client.forms.sale.CSaleChangeMoneyWindow;
import com.e68erp.demo.client.forms.sale.CSaleChangeOrderWindow;
import com.e68erp.demo.client.forms.sale.CSaleChooseOrderChangeDialog;
import com.e68erp.demo.client.forms.sale.CSaleDetailDialog;
import com.e68erp.demo.client.forms.sale.CSaleDetailWindow;
import com.e68erp.demo.client.forms.sale.CSaleGartheringWindow;
import com.e68erp.demo.client.forms.sale.CSaleOrderBackDialog;
import com.e68erp.demo.client.forms.sale.CSaleOrderBackWindow;
import com.e68erp.demo.client.forms.sale.CSaleOrderDialog;
import com.e68erp.demo.client.forms.sale.CSaleOrderWindow;
import com.e68erp.demo.client.forms.sale.CSaleQuoteDialog;
import com.e68erp.demo.client.forms.sale.CSaleQuoteWindow;
import com.e68erp.demo.client.forms.start.CBeginPaymentDialog;
import com.e68erp.demo.client.forms.start.CBeginPaymentWindow;
import com.e68erp.demo.client.forms.start.CBeginReceivableDialog;
import com.e68erp.demo.client.forms.start.CBeginReceivableWindow;
import com.e68erp.demo.client.forms.start.CBeginStorageDialog;
import com.e68erp.demo.client.forms.start.CBeginStorageWindow;
import com.e68erp.demo.client.forms.start.CBeginSubjectDialog;
import com.e68erp.demo.client.forms.start.CBeginSubjectWindow;
import com.e68erp.demo.client.forms.system.CChangePasswordDialog;
import com.e68erp.demo.client.forms.system.CCompanyInfoDialog;
import com.e68erp.demo.client.forms.system.CPermissionTree;
import com.e68erp.demo.client.forms.system.CRegForm;
import com.e68erp.demo.client.forms.system.CRoleManageWindow;
import com.e68erp.demo.client.forms.system.CSystemLogDialog;
import com.e68erp.demo.client.forms.system.CSystemLogWindow;
import com.e68erp.demo.client.forms.system.CSystemOptionDialog;
import com.e68erp.demo.client.forms.system.CUserManageWindow;
import com.e68erp.demo.client.forms.warehouse.CStorageChangeMoneyDialog;
import com.e68erp.demo.client.forms.warehouse.CStorageChangeMoneyWindow;
import com.e68erp.demo.client.forms.warehouse.CStorageCheckDialog;
import com.e68erp.demo.client.forms.warehouse.CStorageCheckWindow;
import com.e68erp.demo.client.forms.warehouse.CStorageInDialog;
import com.e68erp.demo.client.forms.warehouse.CStorageInWindow;
import com.e68erp.demo.client.forms.warehouse.CStorageLossDialog;
import com.e68erp.demo.client.forms.warehouse.CStorageLossWindow;
import com.e68erp.demo.client.forms.warehouse.CStorageMinMaxDialog;
import com.e68erp.demo.client.forms.warehouse.CStorageMinMaxWindow;
import com.e68erp.demo.client.forms.warehouse.CStorageMoveDialog;
import com.e68erp.demo.client.forms.warehouse.CStorageMoveWindow;
import com.e68erp.demo.client.forms.warehouse.CStorageOutDialog;
import com.e68erp.demo.client.forms.warehouse.CStorageOutWindow;
import com.e68erp.demo.client.forms.warehouse.CStorageOutflowDialog;
import com.e68erp.demo.client.forms.warehouse.CStorageOutflowWindow;
import com.e68erp.demo.client.main.Main;
import com.e68erp.demo.client.report.accounting.CCashBankDetailQueryWindow;
import com.e68erp.demo.client.report.accounting.CCashBankMonthReportWindow;
import com.e68erp.demo.client.report.accounting.CCustomerQueryWindow;
import com.e68erp.demo.client.report.accounting.CCustomerReceiveBalanceQueryWindow;
import com.e68erp.demo.client.report.accounting.CCustomerUnbalanceDetailQueryWindow;
import com.e68erp.demo.client.report.accounting.CDailyFeeDetailQueryWindow;
import com.e68erp.demo.client.report.accounting.CDailyFeeReportWindow;
import com.e68erp.demo.client.report.accounting.COtherIncomeDetailQueryWindow;
import com.e68erp.demo.client.report.accounting.COtherIncomeMonthReportWindow;
import com.e68erp.demo.client.report.accounting.CSubjectQueryWindow;
import com.e68erp.demo.client.report.accounting.CSupplierPayBalanceQueryWindow;
import com.e68erp.demo.client.report.accounting.CSupplierQueryWindow;
import com.e68erp.demo.client.report.accounting.CSupplierUnbalanceDetailQueryWindow;
import com.e68erp.demo.client.report.purchase.CEmployeePurchaseDetailQueryWindow;
import com.e68erp.demo.client.report.purchase.CEmployeePurchaseStatReportWindow;
import com.e68erp.demo.client.report.purchase.CProductPurchaseDetailQueryWindow;
import com.e68erp.demo.client.report.purchase.CProductPurchaseGatherReportWindow;
import com.e68erp.demo.client.report.purchase.CProductPurchasePriceWaveReportWindow;
import com.e68erp.demo.client.report.purchase.CProductPurchaseStatReportWindow;
import com.e68erp.demo.client.report.purchase.CPurchaseIndentBalanceQueryWindow;
import com.e68erp.demo.client.report.purchase.CPurchaseIndentPersonStatWindow;
import com.e68erp.demo.client.report.purchase.CPurchaseIndentProBalDetailWindow;
import com.e68erp.demo.client.report.purchase.CPurchaseIndentProBalStatWindow;
import com.e68erp.demo.client.report.purchase.CPurchaseIndentProductQueryWindow;
import com.e68erp.demo.client.report.purchase.CPurchaseIndentProductStatWindow;
import com.e68erp.demo.client.report.purchase.CPurchaseIndentQueryWindow;
import com.e68erp.demo.client.report.purchase.CPurchaseIndentSupplierStatWindow;
import com.e68erp.demo.client.report.purchase.CSupplierPurchaseDetailQueryWindow;
import com.e68erp.demo.client.report.purchase.CSupplierPurchaseStatReportWindow;
import com.e68erp.demo.client.report.sale.CCustomerMonthSaleCompareWindow;
import com.e68erp.demo.client.report.sale.CCustomerSaleDetailQueryWindow;
import com.e68erp.demo.client.report.sale.CCustomerSaleOrderWindow;
import com.e68erp.demo.client.report.sale.CCustomerSaleStatReportWindow;
import com.e68erp.demo.client.report.sale.CEmployeeSaleDetailQueryWindow;
import com.e68erp.demo.client.report.sale.CEmployeeSaleOrderWindow;
import com.e68erp.demo.client.report.sale.CEmployeeSaleStatReportWindow;
import com.e68erp.demo.client.report.sale.CProductMonthSaleCompareWindow;
import com.e68erp.demo.client.report.sale.CProductPriceQueryWindow;
import com.e68erp.demo.client.report.sale.CProductSaleDetailQueryWindow;
import com.e68erp.demo.client.report.sale.CProductSaleGatherReportWindow;
import com.e68erp.demo.client.report.sale.CProductSaleOrderWindow;
import com.e68erp.demo.client.report.sale.CProductSalePriceWaveReportWindow;
import com.e68erp.demo.client.report.sale.CProductSaleStatReportWindow;
import com.e68erp.demo.client.report.sale.CSaleIndentBalanceQueryWindow;
import com.e68erp.demo.client.report.sale.CSaleIndentCustomerStatWindow;
import com.e68erp.demo.client.report.sale.CSaleIndentPersonStatWindow;
import com.e68erp.demo.client.report.sale.CSaleIndentProBalDetailWindow;
import com.e68erp.demo.client.report.sale.CSaleIndentProBalStatWindow;
import com.e68erp.demo.client.report.sale.CSaleIndentProductQueryWindow;
import com.e68erp.demo.client.report.sale.CSaleIndentProductStatWindow;
import com.e68erp.demo.client.report.sale.CSaleIndentQueryWindow;
import com.e68erp.demo.client.report.warehouse.CStorageAlertQueryDialog;
import com.e68erp.demo.client.report.warehouse.CStorageChangeMoneyReportWindow;
import com.e68erp.demo.client.report.warehouse.CStorageCheckQueryWindow;
import com.e68erp.demo.client.report.warehouse.CStorageCheckReportWindow;
import com.e68erp.demo.client.report.warehouse.CStorageInListQueryWindow;
import com.e68erp.demo.client.report.warehouse.CStorageInReportWindow;
import com.e68erp.demo.client.report.warehouse.CStorageLossQueryWindow;
import com.e68erp.demo.client.report.warehouse.CStorageLossReportWindow;
import com.e68erp.demo.client.report.warehouse.CStorageMinMaxQueryWindow;
import com.e68erp.demo.client.report.warehouse.CStorageMoveQueryWindow;
import com.e68erp.demo.client.report.warehouse.CStorageMoveReportWindow;
import com.e68erp.demo.client.report.warehouse.CStorageOutListQueryWindow;
import com.e68erp.demo.client.report.warehouse.CStorageOutReportWindow;
import com.e68erp.demo.client.report.warehouse.CStorageOutflowQueryWindow;
import com.e68erp.demo.client.report.warehouse.CStorageOutflowReportWindow;
import com.e68erp.demo.client.report.warehouse.CStorageQueryWindow;
import com.e68erp.demo.client.util.DateUtilities;
import com.e68erp.demo.client.util.PermissionUtilities;
import com.e68erp.extbeans.CBaseImageItem;
import com.e68erp.extbeans.CGroupPane;
import com.e68erp.extbeans.CHelpInfoPane;
import com.e68erp.extbeans.CImageBackPane;
import com.e68erp.extbeans.CImageItem;
import com.e68erp.extbeans.CLittleImageItem;
import com.e68erp.extbeans.CModulePane;
import com.e68erp.extbeans.CNaviButton;
import com.e68erp.extbeans.CTitlePane;
import com.jdatabeans.beans.CComboBoxPane;
import com.jdatabeans.beans.CMenu;
import com.jdatabeans.beans.CMenuItem;
import com.jdatabeans.beans.CPanel;
import com.jdatabeans.beans.CStatusBar;
import com.jdatabeans.beans.data.IDataSource;
import com.jdatabeans.beans.data.IDbSupport;
import com.jdatabeans.beans.data.JDataTable;
import com.jdatabeans.util.MessageBox;
import com.jdatabeans.util.PaintTools;
import com.jzh.erp.entity.base.Company;
import com.jzh.erp.entity.base.User;
import com.jzh.erp.entity.storage.CheckStoragePo;
import com.jzh.erp.entity.storage.InStoragePo;
import com.jzh.erp.entity.storage.InitialStoragePo;
import com.jzh.erp.entity.storage.LossStoragePo;
import com.jzh.erp.entity.storage.MinMaxStoragePo;
import com.jzh.erp.entity.storage.MoveStoragePo;
import com.jzh.erp.entity.storage.OutStoragePo;
import com.jzh.erp.entity.storage.OutflowStoragePo;
import com.jzh.erp.entity.storage.PriceStoragePo;
import com.jzh.erp.entity.system.Permission;
import com.jzh.erp.service.IPermissionsService;
import com.jzh.erp.service.IStorageService;
import java.awt.Component;
import java.awt.event.InputEvent;
import java.awt.event.KeyAdapter;
import java.awt.event.KeyEvent;
import javax.swing.JPopupMenu;
import javax.swing.JScrollPane;

/**
 *
 * @author afa
 */
public class MainFrame extends JFrame implements MouseListener, ActionListener {

    protected IDataSource dataSource;
    protected JDataTable table;
    protected JPopupMenu mainPopMenu;
    public static final int systemType = 0;
    private Company company;
    private CStatusBar statusBar;
    private JPanel clientPanel;
    private ObjectsPool listObjectPool;
    private CHelpInfoPane helpPane = new CHelpInfoPane();
    private Image companyLogo;
    private ObjectsPool dataBaseObjectPool;
    private JPanel salePanel;
    // base info
    private CMenuItem bProductManageItem = new CMenuItem("商品信息");
    private CMenuItem bCustomerManageItem = new CMenuItem("客户信息");
    private CMenuItem bEmployeeManageItem = new CMenuItem("员工信息");
    private CMenuItem bWarehouseItem = new CMenuItem("仓库信息");
    private CMenuItem bSubjectItem = new CMenuItem("会计科目");
    private CMenuItem mBussinessExpenseItem = new CMenuItem("经营费用");
    private CMenuItem mCommonExpenseItem = new CMenuItem("一般费用");
    private CMenuItem mOtherIncomeItem = new CMenuItem("其它收入");
    private CMenuItem mBankCashItem = new CMenuItem("现金银行");

    //account:
    private CMenuItem mPreReceivableItem = new CMenuItem("销售预收");
    private CMenuItem mReceivableClearingItem = new CMenuItem("收款结算");
    private CMenuItem mPrePayableItem = new CMenuItem("采购预付");
    private CMenuItem mPayableClearingItem = new CMenuItem("付款结算");
    private CMenuItem refreshItem = new CMenuItem("刷新基础数据");
    private CMenuItem bDatabaseItem = new CMenuItem("数据库备份与还原");
    private CMenuItem exitItem = new CMenuItem("退出系统");
    // 系统初始化
    private CMenuItem fStorageBeginManageItem = new CMenuItem("库存期初");
    private CMenuItem bSubjectBeginManageItem = new CMenuItem("科目期初");
    private CMenuItem bReceivableBeginMangeItem = new CMenuItem("应收期初");
    private CMenuItem bPaymentBeginManageItem = new CMenuItem("应付期初");

    //
    private CMenuItem pOrderItem = new CMenuItem("采购订单");
    private CMenuItem pPurchaseItem = new CMenuItem("采购单");
    private CMenuItem pPaymentItem = new CMenuItem("付款结算");
    private CMenuItem pOrderChangedItem = new CMenuItem("订单变更");
    private CMenuItem pOrderBack = new CMenuItem("采购退货");

    //
    private CMenuItem sQuoteItem = new CMenuItem("商品报价");
    private CMenuItem sOrderItem = new CMenuItem("销售订单");
    private CMenuItem sSaleListItem = new CMenuItem("销售单");
    private CMenuItem sGartheringItem = new CMenuItem("收款结算");
    private CMenuItem sAjustPriceItem = new CMenuItem("商品调价");
    private CMenuItem sOrderChangedItem = new CMenuItem("订单变更");
    private CMenuItem sOrderBackItem = new CMenuItem("销售退货");
    // warehouse
    private CMenuItem wStorageInItem = new CMenuItem("商品入库");
    private CMenuItem wStorageOutItem = new CMenuItem("商品出库");
    private CMenuItem wStorageOutflowItem = new CMenuItem("库存报溢");
    private CMenuItem wStorageLossItem = new CMenuItem("库存报损");
    private CMenuItem wStorageCheckItem = new CMenuItem("盘点管理");
    private CMenuItem wStorageMoveItem = new CMenuItem("移库管理");
    private CMenuItem wStorageChangeMoneyItem = new CMenuItem("库存变价");
    private CMenuItem wStorageMaxMinItem = new CMenuItem("库存上下限");
    // produce

    // system
    private CMenuItem sCompanyInfoItem = new CMenuItem("公司信息");
    //private CMenuItem sRoleItem = new CMenuItem("角色管理");
    private CMenuItem sUserItem = new CMenuItem("用户管理");
    private CMenuItem sChangePasswordItem = new CMenuItem("修改密码");
    private CMenuItem sLogItem = new CMenuItem("系统日志");
    private CMenuItem sOptionItem = new CMenuItem("系统选项");
    private CMenuItem sNumberManageItem = new CMenuItem("编号管理");
    private CMenu sListManage = new CMenu("下拉框管理");
    //liufei
    //sListManage
    private CMenuItem sListProUnitItem = new CMenuItem("商品单位");
    private CMenuItem sListProShelfItem = new CMenuItem("商品货位");
    private CMenuItem sListProTaxrateItem = new CMenuItem("商品税率");
    private CMenuItem sListCusTypeItem = new CMenuItem("客户类型");
    private CMenuItem sListCusPriceItem = new CMenuItem("默认价格");
    private CMenuItem sListCusInvoiceItem = new CMenuItem("发票类型");
    private CMenuItem sListEmpDutyItem = new CMenuItem("员工职务");
    private CMenuItem sListEmpDegreeItem = new CMenuItem("员工职称");
    private CMenuItem sListEmpLevelItem = new CMenuItem("文化程度");
    private CMenuItem sListEmpHealthItem = new CMenuItem("健康状况");
    private CMenuItem sListStoTypeItem = new CMenuItem("仓库类型");
    // view
    private JCheckBoxMenuItem vShowNavigationItem = new JCheckBoxMenuItem(
            "显示导航栏");
    private JCheckBoxMenuItem vShowToolbarItem = new JCheckBoxMenuItem("显示工具条");
    private JCheckBoxMenuItem vShowLogItem = new JCheckBoxMenuItem("显示系统日志");
    //private CMenuItem vLookAndFeelItem = new CMenuItem("界面风格");

    //report
    private CMenu rStorageReportMenu = new CMenu("仓库报表");
    private CMenuItem rStorageBalanceItem = new CMenuItem("库存商品余额查询");
    private CMenuItem rStorageInDetailedItem = new CMenuItem("库存入库明细查询");
    private CMenuItem rStorageOutDetailedItem = new CMenuItem("库存出库明细查询");
    private CMenuItem rStorageInItem = new CMenuItem("库存商品入库查询");
    private CMenuItem rStorageOutItem = new CMenuItem("库存商品出库查询");
    private CMenuItem rStorageMaxMinItem = new CMenuItem("库存商品上下限查询");
    private CMenuItem rStorageAlertItem = new CMenuItem("库存警报查询");
    private CMenuItem rStorageMoveReporItem = new CMenuItem("库存商品移库明细");
    private CMenuItem rStorageCheckReporItem = new CMenuItem("库存商品盘点明细");
    private CMenuItem rStorageOutflowReporItem = new CMenuItem("库存商品报溢明细");
    private CMenuItem rStorageLossReporItem = new CMenuItem("库存商品报损明细");
    private CMenuItem rStorageChangeMoneyItem = new CMenuItem("库存商品变价明细");
    private CMenuItem rStorageMoveItem = new CMenuItem("库存商品移库查询");
    private CMenuItem rStorageCheckItem = new CMenuItem("库存商品盘点查询");
    private CMenuItem rStorageOutflowItem = new CMenuItem("库存商品报溢查询");
    private CMenuItem rStorageLossItem = new CMenuItem("库存商品报损查询");

    //	private CMenuItem rSupplierTradeDetailItem = new CMenuItem("供应商往来流水查询");
    //	private CMenuItem rCustomerTradeDetailItem = new CMenuItem("往来流水查询");

    //purchase report
    private CMenu rPurchaseReportMenu = new CMenu("采购报表");
    private CMenuItem rPurchaseIndentItem = new CMenuItem("采购订单查询");
    private CMenuItem rPurchaseIndentProStatItem = new CMenuItem("采购订单商品统计");
    private CMenuItem rPurchaseIndentProductItem = new CMenuItem("采购订单商品明细");
    private CMenuItem rPurchaseIndentBalanceItem = new CMenuItem("采购订单余额查询");////暂时屏蔽
    private CMenuItem rPurchaseIndentProBalStatItem = new CMenuItem("采购订单商品余额统计");////暂时屏蔽
    private CMenuItem rPurchaseIndentProBalDetailItem = new CMenuItem("采购订单商品余额明细查询");////暂时屏蔽
    private CMenuItem rPurchaseIndentSupplierStatItem = new CMenuItem("采购订单供应商统计");
    private CMenuItem rPurchaseIndentPersonStatItem = new CMenuItem("采购订单业务员统计");
    private CMenuItem rProductPurchaseStatItem = new CMenuItem("商品采购统计表");
    private CMenuItem rProductPurchaseDetailItem = new CMenuItem("商品采购明细查询");
    private CMenuItem rSupplierPurchaseStatItem = new CMenuItem("供应商采购统计表");
    private CMenuItem rSupplierPurchaseDetailItem = new CMenuItem("供应商采购明细查询");
    private CMenuItem rEmployeePurchaseStatItem = new CMenuItem("职员采购统计表");
    private CMenuItem rEmployeePurchaseDetailItem = new CMenuItem("职员采购明细查询");
    private CMenuItem rProductPurchaseGatherItem = new CMenuItem("商品采购汇总表");////暂时屏蔽
    private CMenuItem rProductPurchasePriceWaveItem = new CMenuItem("商品采购价格波动表");////暂时屏蔽
    private CMenu rSaleReportMenu = new CMenu("销售报表");
    private CMenuItem rSaleIndentItem = new CMenuItem("销售订单查询");
    private CMenuItem rSaleIndentProStatItem = new CMenuItem("销售订单商品统计");
    private CMenuItem rSaleIndentProductItem = new CMenuItem("销售订单商品明细");
    private CMenuItem rSaleIndentBalanceItem = new CMenuItem("销售订单余额查询");////暂时屏蔽
    private CMenuItem rSaleIndentProBalStatItem = new CMenuItem("销售订单商品余额统计");////暂时屏蔽
    private CMenuItem rSaleIndentProBalDetailItem = new CMenuItem("销售订单商品余额明细查询");////暂时屏蔽
    private CMenuItem rSaleIndentCustomerStatItem = new CMenuItem("销售订单客商统计");
    private CMenuItem rSaleIndentPersonStatItem = new CMenuItem("销售订单业务员统计");
//    private CMenuItem rCustomerMonthSaleCompareItem = new CMenuItem("客商月销售比较表");
//    private CMenuItem rProductMonthSaleCompareItem = new CMenuItem("商品月销售比较表");
//    private CMenuItem rCustomerSaleOrderItem = new CMenuItem("客商销售排行榜");
//    private CMenuItem rProductSaleOrderItem = new CMenuItem("商品销售排行榜");
//    private CMenuItem rEmployeeSaleOrderItem = new CMenuItem("职员销售排行榜");
    private CMenuItem rProductSaleStatItem = new CMenuItem("商品销售统计表");
    private CMenuItem rProductSaleDetailItem = new CMenuItem("商品销售明细查询");
    private CMenuItem rCustomerSaleStatItem = new CMenuItem("客商销售统计表");
    private CMenuItem rCustomerSaleDetailItem = new CMenuItem("客商销售明细查询");
    private CMenuItem rEmployeeSaleStatItem = new CMenuItem("职员销售统计表");
    private CMenuItem rEmployeeSaleDetailItem = new CMenuItem("职员销售明细查询");
//    private CMenuItem rProductSaleGatherItem = new CMenuItem("商品销售汇总表");
//    private CMenuItem rProductPriceItem = new CMenuItem("商品价格查询");
//    private CMenuItem rProductSalePriceWaveItem = new CMenuItem("商品销售价格波动表");
    private CMenu rFinanceReportMenu = new CMenu("财务报表");
    private CMenuItem rSubjectBalanceItem = new CMenuItem("科目余额查询");
    private CMenuItem rCashBankMonthReportItem = new CMenuItem("现金银行月报表");////暂时屏蔽
    private CMenuItem rCashBankDetailItem = new CMenuItem("现金银行明细查询");////暂时屏蔽
    private CMenuItem rDailyFeeReportItem = new CMenuItem("日常费用报表");
    private CMenuItem rDailyFeeDetailItem = new CMenuItem("日常费用明细查询");
    private CMenuItem rOtherIncomeMonthReportItem = new CMenuItem("其它收入月报表");////暂时屏蔽
    private CMenuItem rOtherIncomeDetailItem = new CMenuItem("其它收入明细查询");////暂时屏蔽
    private CMenu rBalanceReportMenu = new CMenu("结算报表");
    private CMenuItem rSupplierPayBalanceItem = new CMenuItem("供应商应付余额查询");
    private CMenuItem rSupplierUnbalanceDetailItem = new CMenuItem("供应商未结明细查询");
    private CMenuItem rCustomerReceiveBalanceItem = new CMenuItem("客商应收余额查询");
    private CMenuItem rCustomerUnbalanceDetailItem = new CMenuItem("客商未结明细查询");
    private CMenuItem rSupplierQueryItem = new CMenuItem("供应商往来流水查询");////暂时屏蔽
    private CMenuItem rCustomerQueryItem = new CMenuItem("客商往来流水查询");////暂时屏蔽

    //help
    private CMenuItem hContentItem = new CMenuItem("帮助手册");
    private CMenuItem hAboutItem = new CMenuItem("关于本系统");
    private Image mainIcon;
    private IPermissionsService service = Main.getServiceManager().getPermissionsService();
    private User user;
    private ProductSelectPanel productSelectPanel;
    private HashMap<String, ImageIcon> icons = new HashMap<String, ImageIcon>();

    public MainFrame() {
        initComp();
    }

    private void initIcons() {
        this.icons.put("add", new ImageIcon(getClass().getResource(
                "/resources/add.gif")));
        this.icons.put("edit", new ImageIcon(getClass().getResource(
                "/resources/page_edit.gif")));

        this.icons.put("saveandnew", new ImageIcon(getClass().getResource(
                "/resources/saveandnew.gif")));
        this.icons.put("new", new ImageIcon(getClass().getResource(
                "/resources/page_add.gif")));
        this.icons.put("open", new ImageIcon(getClass().getResource(
                "/resources/open.gif")));
        this.icons.put("delete", new ImageIcon(getClass().getResource(
                "/resources/page_delete.gif")));
        this.icons.put("export", new ImageIcon(getClass().getResource(
                "/resources/page_excel.gif")));
        this.icons.put("save", new ImageIcon(getClass().getResource(
                "/resources/page_save.gif")));
        this.icons.put("next", new ImageIcon(getClass().getResource(
                "/resources/next.gif")));
        this.icons.put("previous", new ImageIcon(getClass().getResource(
                "/resources/previous.gif")));

        this.icons.put("addtype", new ImageIcon(getClass().getResource(
                "/resources/page_addlb.gif")));
        this.icons.put("edittype", new ImageIcon(getClass().getResource(
                "/resources/page_modlb.gif")));
        this.icons.put("deletetype", new ImageIcon(getClass().getResource(
                "/resources/page_dellb.gif")));
        this.icons.put("next", new ImageIcon(getClass().getResource(
                "/resources/fastforward.gif")));
        this.icons.put("import", new ImageIcon(getClass().getResource(
                "/resources/page_excel.gif")));
        this.icons.put("previous", new ImageIcon(getClass().getResource(
                "/resources/rewind.gif")));
        this.icons.put("default", new ImageIcon(getClass().getResource(
                "/resources/default.gif")));
        this.icons.put("last", new ImageIcon(getClass().getResource(
                "/resources/endpage.gif")));
        this.icons.put("first", new ImageIcon(getClass().getResource(
                "/resources/homepage.gif")));
        this.icons.put("print", new ImageIcon(getClass().getResource(
                "/resources/page_print.gif")));
//        this.icons.put("printpreview", new ImageIcon(getClass().getResource(
//                "/resources/printpreview.gif")));
//        this.icons.put("close", new ImageIcon(getClass().getResource(
//                "/resources/page_close.gif")));
//        this.icons.put("refresh", new ImageIcon(getClass().getResource(
//                "/resources/main/refresh.png")));
    }

    public Image getMainImage() {
        return this.mainIcon;
    }

    public Image getCompanyLogo() {
        if (this.companyLogo == null) {
            this.companyLogo = Main.getServiceManager().getCompanyService().getCompany(company.getId()).getImage();
        }
        return this.companyLogo;
    }

    public ImageIcon getIcon(String key) {
        ImageIcon icon = this.icons.get(key);
        if (icon == null) {
            return this.icons.get("default");
        }
        return icon;
    }

    private void initComp() {
        try {
            mainIcon = ImageIO.read(this.getClass().getResource("/resources/mainicon.png"));
            this.setIconImage(mainIcon);
            this.setTitle("企业进销存");
        } catch (Exception ex) {
            ex.printStackTrace();
        }
        initIcons();
        Dimension d = Toolkit.getDefaultToolkit().getScreenSize();
        this.setSize(d.width, d.height - 30);
        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        initMenu();
        this.loadStatusBar();
        this.getContentPane().setBackground(Color.white);
        this.getContentPane().add("North", createTopPane());

        this.getContentPane().add("West", this.createModulePane());
        clientPanel = this.createClientPane();
        clientPanel.setLayout(null);
        this.getContentPane().add("Center", clientPanel);
        initPanels();
        this.clientPanel.add(helpPane);

        installListeners();


    }

    public void setCompany(Company company) {
        this.company = company;
    }

    public Company getCompany() {
        return this.company;
    }

    public User getUser() {
        return user;
    }

    public void setUser(User user) {
        this.user = user;
    }

    private void initMenu() {
        //end listeners;
        //menus
        JMenuBar menuBar = new JMenuBar();
        this.setJMenuBar(menuBar);
        CMenu sysMenu = new CMenu("系统(&S)");


        sysMenu.add(sCompanyInfoItem);
        sysMenu.addSeparator();
        sysMenu.add(fStorageBeginManageItem);
        sysMenu.add(bSubjectBeginManageItem);
        sysMenu.add(bReceivableBeginMangeItem);
        sysMenu.add(bPaymentBeginManageItem);
        sysMenu.addSeparator();



        //systemMenu.add(sRoleItem);//liufei
        sysMenu.add(sUserItem);
        sysMenu.add(sChangePasswordItem);
        sysMenu.add(sLogItem);
        sysMenu.addSeparator();
        //systemMenu.add(this.sOptionItem);//no show
        sysMenu.add(this.sNumberManageItem);//
        //systemMenu.add(this.sListManage);
        sysMenu.addSeparator();
        sysMenu.add(this.exitItem);
        menuBar.add(sysMenu);


        CMenu baseMenu = new CMenu("基础资料(&B)");

//        bProductManageItem.setIcon(new ImageIcon(getClass().getResource("/resources/main/product16.png")));
//        bCustomerManageItem.setIcon(new ImageIcon(getClass().getResource("/resources/main/usersinfo16.png")));
//        bEmployeeManageItem.setIcon(new ImageIcon(getClass().getResource("/resources/main/workerinfo16.png")));
//        bWarehouseItem.setIcon(new ImageIcon(getClass().getResource("/resources/main/newsstock16.png")));
        menuBar.add(baseMenu);
        CMenu productMenu = new CMenu("商品(&M)");
        baseMenu.add(productMenu);
        productMenu.add(bProductManageItem);
        productMenu.addSeparator();
        productMenu.add(sListProUnitItem);
        productMenu.add(sListProShelfItem);
        productMenu.add(sListProTaxrateItem);
        CMenu storageMenu = new CMenu("仓库(&S)");
        baseMenu.add(storageMenu);
        storageMenu.add(bWarehouseItem);
        CMenu customerMenu = new CMenu("往来单位(&T)");
        baseMenu.add(customerMenu);
        customerMenu.add(bCustomerManageItem);
        CMenu employeeMenu = new CMenu("部门职员(&G)");
        baseMenu.add(employeeMenu);
        employeeMenu.add(this.bEmployeeManageItem);
        baseMenu.addSeparator();
        baseMenu.add(bSubjectItem);
        baseMenu.addSeparator();
        baseMenu.add(refreshItem);

        //*********************
        CMenu subMenu = new CMenu("功能模块(&F)");
        menuBar.add(subMenu);
        //
        CMenu purchaseMenu = new CMenu("采购管理");
        subMenu.add(purchaseMenu);
        //menuBar.add(purchaseMenu);
        purchaseMenu.add(this.pOrderItem);
        purchaseMenu.add(this.pPurchaseItem);
        purchaseMenu.add(this.pPaymentItem);
        purchaseMenu.add(this.pOrderChangedItem);
        purchaseMenu.add(this.pOrderBack);


        CMenu saleMenu = new CMenu("销售管理");
        //menuBar.add(saleMenu);
        subMenu.add(saleMenu);
        saleMenu.add(sQuoteItem);
        saleMenu.add(sOrderItem);
        saleMenu.add(sSaleListItem);
        saleMenu.add(sGartheringItem);
        saleMenu.add(this.sAjustPriceItem);
        saleMenu.add(this.sOrderChangedItem);
        saleMenu.add(this.sOrderBackItem);

        CMenu warehouseMenu = new CMenu("仓存管理");
        //menuBar.add(warehouseMenu);
        subMenu.add(warehouseMenu);

        CMenu purchasePaymentMenu = new CMenu("应收应付(&M)");
        purchasePaymentMenu.add(mPreReceivableItem);
        purchasePaymentMenu.add(mReceivableClearingItem);
        purchasePaymentMenu.add(mPrePayableItem);
        purchasePaymentMenu.add(mPayableClearingItem);
        subMenu.add(purchasePaymentMenu);

        CMenu moneyBankMenu = new CMenu("财务管理(&K)");
        moneyBankMenu.add(mBussinessExpenseItem);
        moneyBankMenu.add(mCommonExpenseItem);
        moneyBankMenu.add(mOtherIncomeItem);
        moneyBankMenu.add(mBankCashItem);

        subMenu.add(moneyBankMenu);

        warehouseMenu.add(this.wStorageInItem);
        warehouseMenu.add(this.wStorageOutItem);
        warehouseMenu.add(this.wStorageOutflowItem);
        warehouseMenu.add(this.wStorageLossItem);
        warehouseMenu.add(this.wStorageCheckItem);
        warehouseMenu.add(this.wStorageMoveItem);
        warehouseMenu.add(this.wStorageChangeMoneyItem);
        warehouseMenu.add(this.wStorageMaxMinItem);
        //CMenu produceMenu = new CMenu("浜х＄(&D)");
        //menuBar.add(produceMenu);

        ////liufei
        sListManage.add(this.sListProUnitItem);
        sListManage.add(this.sListProShelfItem);
        sListManage.add(this.sListProTaxrateItem);
        sListManage.add(this.sListCusTypeItem);
        //sListManage.add(this.sListCusPriceItem);
        //sListManage.add(this.sListCusInvoiceItem);
        sListManage.add(this.sListEmpDutyItem);
        sListManage.add(this.sListEmpDegreeItem);
        sListManage.add(this.sListEmpLevelItem);
        sListManage.add(this.sListEmpHealthItem);
        sListManage.add(this.sListStoTypeItem);

        CMenu reportMenu = new CMenu("报表(&R)");
        menuBar.add(reportMenu);

        reportMenu.add(rPurchaseReportMenu);
        rPurchaseReportMenu.add(rPurchaseIndentItem);
        rPurchaseReportMenu.add(rPurchaseIndentProStatItem);
        rPurchaseReportMenu.add(rPurchaseIndentProductItem);
        //rPurchaseReportMenu.add(rPurchaseIndentBalanceItem);
        //rPurchaseReportMenu.add(rPurchaseIndentProBalStatItem);
        //rPurchaseReportMenu.add(rPurchaseIndentProBalDetailItem);
        rPurchaseReportMenu.add(rPurchaseIndentSupplierStatItem);
        rPurchaseReportMenu.add(rPurchaseIndentPersonStatItem);
        rPurchaseReportMenu.add(rProductPurchaseStatItem);
        rPurchaseReportMenu.add(rProductPurchaseDetailItem);
        rPurchaseReportMenu.add(rSupplierPurchaseStatItem);
        rPurchaseReportMenu.add(rSupplierPurchaseDetailItem);
        rPurchaseReportMenu.add(rEmployeePurchaseStatItem);
        rPurchaseReportMenu.add(rEmployeePurchaseDetailItem);
        //rPurchaseReportMenu.add(rProductPurchaseGatherItem);
        //rPurchaseReportMenu.add(rProductPurchasePriceWaveItem);
        reportMenu.addSeparator();

        reportMenu.add(rSaleReportMenu);
        rSaleReportMenu.add(rSaleIndentItem);
        rSaleReportMenu.add(rSaleIndentProStatItem);
        rSaleReportMenu.add(rSaleIndentProductItem);
        //rSaleReportMenu.add(rSaleIndentBalanceItem);
        //rSaleReportMenu.add(rSaleIndentProBalStatItem);
        //rSaleReportMenu.add(rSaleIndentProBalDetailItem);
        rSaleReportMenu.add(rSaleIndentCustomerStatItem);
        rSaleReportMenu.add(rSaleIndentPersonStatItem);
//        rSaleReportMenu.add(rCustomerMonthSaleCompareItem);
//        rSaleReportMenu.add(rProductMonthSaleCompareItem);
////        rSaleReportMenu.add(rCustomerSaleOrderItem);
//        rSaleReportMenu.add(rProductSaleOrderItem);
//        rSaleReportMenu.add(rEmployeeSaleOrderItem);
        rSaleReportMenu.add(rProductSaleStatItem);
        rSaleReportMenu.add(rProductSaleDetailItem);
        rSaleReportMenu.add(rCustomerSaleStatItem);
        rSaleReportMenu.add(rCustomerSaleDetailItem);
        rSaleReportMenu.add(rEmployeeSaleStatItem);
        rSaleReportMenu.add(rEmployeeSaleDetailItem);

//        rSaleReportMenu.add(rProductSaleGatherItem);
//        rSaleReportMenu.add(rProductPriceItem);
//        rSaleReportMenu.add(rProductSalePriceWaveItem);
        reportMenu.addSeparator();

        reportMenu.add(rStorageReportMenu);
        rStorageReportMenu.add(rStorageBalanceItem);
        rStorageReportMenu.add(rStorageInItem);
        rStorageReportMenu.add(rStorageOutItem);
        //rStorageReportMenu.add(rStorageMoveItem);////跺
        rStorageReportMenu.add(rStorageCheckItem);
        rStorageReportMenu.add(rStorageOutflowItem);
        rStorageReportMenu.add(rStorageLossItem);
        rStorageReportMenu.add(rStorageMaxMinItem);
        rStorageReportMenu.add(rStorageAlertItem);
        rStorageReportMenu.addSeparator();
        rStorageReportMenu.add(rStorageInDetailedItem);
        rStorageReportMenu.add(rStorageOutDetailedItem);
        //rStorageReportMenu.add(rStorageMoveReporItem);////跺
        rStorageReportMenu.add(rStorageCheckReporItem);
        rStorageReportMenu.add(rStorageOutflowReporItem);
        rStorageReportMenu.add(rStorageLossReporItem);
        rStorageReportMenu.add(rStorageChangeMoneyItem);
        reportMenu.addSeparator();

        reportMenu.add(rFinanceReportMenu);
        rFinanceReportMenu.add(rSubjectBalanceItem);
        rFinanceReportMenu.add(rCashBankMonthReportItem);
        rFinanceReportMenu.add(rCashBankDetailItem);
        rFinanceReportMenu.add(rDailyFeeReportItem);
        rFinanceReportMenu.add(rDailyFeeDetailItem);
        rFinanceReportMenu.add(rOtherIncomeMonthReportItem);
        rFinanceReportMenu.add(rOtherIncomeDetailItem);
        reportMenu.addSeparator();

        reportMenu.add(rBalanceReportMenu);
        rBalanceReportMenu.add(rSupplierPayBalanceItem);
        rBalanceReportMenu.add(rSupplierUnbalanceDetailItem);
        rBalanceReportMenu.add(rCustomerReceiveBalanceItem);
        rBalanceReportMenu.add(rCustomerUnbalanceDetailItem);
        //rBalanceReportMenu.add(rSupplierQueryItem);
        //rBalanceReportMenu.add(rCustomerQueryItem);

//        CMenu viewMenu = new CMenu("视图(&V)");
//        menuBar.add(viewMenu);
//        viewMenu.add(this.vShowNavigationItem);
//        //vShowNavigationItem.setArmed(true);
//        //viewMenu.add(this.vShowToolbarItem);
//        viewMenu.add(this.vShowLogItem);
//        viewMenu.addSeparator();
        //viewMenu.add(this.vLookAndFeelItem);

        CMenu helpMenu = new CMenu("帮助(&H)");

//        hContentItem.setIcon(new ImageIcon(getClass().getResource("/resources/main/help16.png")));
//        hAboutItem.setIcon(new ImageIcon(getClass().getResource("/resources/main/main16.png")));
        menuBar.add(helpMenu);
        helpMenu.add(this.hContentItem);
        helpMenu.add(this.hAboutItem);

        //
        this.vShowLogItem.setSelected(true);
        this.vShowNavigationItem.setSelected(true);
        this.vShowToolbarItem.setSelected(true);



    }

    private void installListeners() {
        bProductManageItem.addActionListener(this);
        bCustomerManageItem.addActionListener(this);
        bEmployeeManageItem.addActionListener(this);
        bWarehouseItem.addActionListener(this);
        bSubjectItem.addActionListener(this);
        mBussinessExpenseItem.addActionListener(this);
        mCommonExpenseItem.addActionListener(this);
        mOtherIncomeItem.addActionListener(this);
        mBankCashItem.addActionListener(this);
        mPreReceivableItem.addActionListener(this);
        mReceivableClearingItem.addActionListener(this);
        mPrePayableItem.addActionListener(this);
        mPayableClearingItem.addActionListener(this);
        refreshItem.addActionListener(this);
        bDatabaseItem.addActionListener(this);
        exitItem.addActionListener(this);
        fStorageBeginManageItem.addActionListener(this);
        bSubjectBeginManageItem.addActionListener(this);
        bReceivableBeginMangeItem.addActionListener(this);
        bPaymentBeginManageItem.addActionListener(this);
        pOrderItem.addActionListener(this);
        pPurchaseItem.addActionListener(this);
        pPaymentItem.addActionListener(this);
        pOrderBack.addActionListener(this);
        sQuoteItem.addActionListener(this);
        sOrderItem.addActionListener(this);
        sSaleListItem.addActionListener(this);
        sGartheringItem.addActionListener(this);
        sAjustPriceItem.addActionListener(this);
        sOrderBackItem.addActionListener(this);
        wStorageInItem.addActionListener(this);
        wStorageOutItem.addActionListener(this);
        wStorageOutflowItem.addActionListener(this);
        wStorageLossItem.addActionListener(this);
        wStorageCheckItem.addActionListener(this);
        wStorageMoveItem.addActionListener(this);
        wStorageChangeMoneyItem.addActionListener(this);
        wStorageMaxMinItem.addActionListener(this);
        sCompanyInfoItem.addActionListener(this);
        sUserItem.addActionListener(this);
        sChangePasswordItem.addActionListener(this);
        sLogItem.addActionListener(this);
        sOptionItem.addActionListener(this);
        sNumberManageItem.addActionListener(this);
        sListManage.addActionListener(this);
        sListProUnitItem.addActionListener(this);
        sListProShelfItem.addActionListener(this);
        sListProTaxrateItem.addActionListener(this);
        sListCusTypeItem.addActionListener(this);

        sListCusPriceItem.addActionListener(this);
        sListCusInvoiceItem.addActionListener(this);
        sListEmpDutyItem.addActionListener(this);
        sListEmpDegreeItem.addActionListener(this);
        sListEmpLevelItem.addActionListener(this);
        sListEmpHealthItem.addActionListener(this);
        sListStoTypeItem.addActionListener(this);
        rStorageBalanceItem.addActionListener(this);
        rStorageInDetailedItem.addActionListener(this);
        rStorageOutDetailedItem.addActionListener(this);
        rStorageInItem.addActionListener(this);
        rStorageOutItem.addActionListener(this);
        rStorageMaxMinItem.addActionListener(this);
        rStorageAlertItem.addActionListener(this);
        rStorageMoveReporItem.addActionListener(this);
        rStorageCheckReporItem.addActionListener(this);
        rStorageOutflowReporItem.addActionListener(this);
        rStorageLossReporItem.addActionListener(this);
        rStorageChangeMoneyItem.addActionListener(this);
        rStorageMoveItem.addActionListener(this);
        rStorageCheckItem.addActionListener(this);
        rStorageOutflowItem.addActionListener(this);
        rStorageLossItem.addActionListener(this);
        rPurchaseIndentItem.addActionListener(this);
        rPurchaseIndentProStatItem.addActionListener(this);
        rPurchaseIndentProductItem.addActionListener(this);
        rPurchaseIndentBalanceItem.addActionListener(this);
        rPurchaseIndentProBalStatItem.addActionListener(this);       //("采购订单商品余额统计");////暂时屏蔽
        rPurchaseIndentProBalDetailItem.addActionListener(this);       //("采购订单商品余额明细查询");////暂时屏蔽
        rPurchaseIndentSupplierStatItem.addActionListener(this);       //("采购订单供应商统计");
        rPurchaseIndentPersonStatItem.addActionListener(this);       //("采购订单业务员统计");
        rProductPurchaseStatItem.addActionListener(this);       //("商品采购统计表");
        rProductPurchaseDetailItem.addActionListener(this);       //("商品采购明细查询");
        rSupplierPurchaseStatItem.addActionListener(this);       //("供应商采购统计表");
        rSupplierPurchaseDetailItem.addActionListener(this);       //("供应商采购明细查询");
        rEmployeePurchaseStatItem.addActionListener(this);       //("职员采购统计表");
        rEmployeePurchaseDetailItem.addActionListener(this);       //("职员采购明细查询");
        rProductPurchaseGatherItem.addActionListener(this);       //("商品采购汇总表");////暂时屏蔽
        rProductPurchasePriceWaveItem.addActionListener(this);       //("商品采购价格波动表");////暂时屏蔽

        rSaleIndentItem.addActionListener(this);       //("销售订单查询");
        rSaleIndentProStatItem.addActionListener(this);       //("销售订单商品统计");
        rSaleIndentProductItem.addActionListener(this);       //("销售订单商品明细");
        rSaleIndentBalanceItem.addActionListener(this);       //("销售订单余额查询");////暂时屏蔽
        rSaleIndentProBalStatItem.addActionListener(this);       //("销售订单商品余额统计");////暂时屏蔽
        rSaleIndentProBalDetailItem.addActionListener(this);       //("销售订单商品余额明细查询");////暂时屏蔽
        rSaleIndentCustomerStatItem.addActionListener(this);       //("销售订单客商统计");
        rSaleIndentPersonStatItem.addActionListener(this);       //("销售订单业务员统计");
//    rCustomerMonthSaleCompareItem.addActionListener(this);       //("客商月销售比较表");
//    rProductMonthSaleCompareItem.addActionListener(this);       //("商品月销售比较表");
//    rCustomerSaleOrderItem.addActionListener(this);       //("客商销售排行榜");
//    rProductSaleOrderItem.addActionListener(this);       //("商品销售排行榜");
//    rEmployeeSaleOrderItem.addActionListener(this);       //("职员销售排行榜");
        rProductSaleStatItem.addActionListener(this);       //("商品销售统计表");
        rProductSaleDetailItem.addActionListener(this);       //("商品销售明细查询");
        rCustomerSaleStatItem.addActionListener(this);       //("客商销售统计表");
        rCustomerSaleDetailItem.addActionListener(this);       //("客商销售明细查询");
        rEmployeeSaleStatItem.addActionListener(this);       //("职员销售统计表");
        rEmployeeSaleDetailItem.addActionListener(this);       //("职员销售明细查询");
//    rProductSaleGatherItem.addActionListener(this);       //("商品销售汇总表");
//    rProductPriceItem.addActionListener(this);       //("商品价格查询");
//    rProductSalePriceWaveItem.addActionListener(this);       //("商品销售价格波动表");

        rSubjectBalanceItem.addActionListener(this);       //("科目余额查询");
        rCashBankMonthReportItem.addActionListener(this);       //("现金银行月报表");////暂时屏蔽
        rCashBankDetailItem.addActionListener(this);       //("现金银行明细查询");////暂时屏蔽
        rDailyFeeReportItem.addActionListener(this);       //("日常费用报表");
        rDailyFeeDetailItem.addActionListener(this);       //("日常费用明细查询");
        rOtherIncomeMonthReportItem.addActionListener(this);       //("其它收入月报表");////暂时屏蔽
        rOtherIncomeDetailItem.addActionListener(this);       //("其它收入明细查询");////暂时屏蔽
        rSupplierPayBalanceItem.addActionListener(this);       //("供应商应付余额查询");
        rSupplierUnbalanceDetailItem.addActionListener(this);       //("供应商未结明细查询");
        rCustomerReceiveBalanceItem.addActionListener(this);       //("客商应收余额查询");
        rCustomerUnbalanceDetailItem.addActionListener(this);       //("客商未结明细查询");
        rSupplierQueryItem.addActionListener(this);       //("供应商往来流水查询");////暂时屏蔽
        rCustomerQueryItem.addActionListener(this);       //("客商往来流水查询");////暂时屏蔽

        //help
        hContentItem.addActionListener(this);       //("帮助手册");
        hAboutItem.addActionListener(this);       //("关于本系统");


        productImageItem.addMouseListener(this);
        customerImageItem.addMouseListener(this);
        employeeImageItem.addMouseListener(this);
        storageImageItem.addMouseListener(this);
        subjectImageItem.addMouseListener(this);

        mBussinessExpenseImageItem.addMouseListener(this);// = new CMenuImageItem("缁ヨ垂");
        mBussinessExpenseImageItemList.addMouseListener(this);
        mCommonExpenseImageItem.addMouseListener(this);// = new CMenuItem("涓?璐圭");
        mCommonExpenseImageItemList.addMouseListener(this);
        mOtherIncomeImageItem.addMouseListener(this);//= new CMenuItem("跺跺");
        mOtherIncomeImageItemList.addMouseListener(this);
        mBankCashImageItem.addMouseListener(this);// = new CMenuItem("惰甯");
        mBankCashImageItemList.addMouseListener(this);

        fStorageBeginManageImageItem.addMouseListener(this);
        fStorageBeginManageImageItemList.addMouseListener(this);
        bSubjectBeginManageImageItem.addMouseListener(this);// = new CImageItem("绉浣棰绠＄");
        bSubjectBeginManageImageItemList.addMouseListener(this);
        bReceivableBeginMangeImageItem.addMouseListener(this);// = new CImageItem("搴舵绠＄");
        bReceivableBeginMangeImageItemList.addMouseListener(this);
        bPaymentBeginManageImageItem.addMouseListener(this);// = new CImageItem("搴浠绠＄");
        bPaymentBeginManageImageItemList.addMouseListener(this);
        //purchase
        pOrderImageItem.addMouseListener(this);// = new CMenuItem("璐璁㈠");
        pOrderImageItemList.addMouseListener(this);
        pPurchaseImageItem.addMouseListener(this);// = new CMenuItem("璐?);
        pPurchaseImageItemList.addMouseListener(this);

        pPaymentImageItem.addMouseListener(this);// = new CMenuItem("浠娆剧绠");
        pPaymentImageItemList.addMouseListener(this);

        pOrderChangedImageItem.addMouseListener(this);// = new CMenuItem("璁㈠");
        pOrderChangedImageItemList.addMouseListener(this);

        pOrderBackImageItem.addMouseListener(this);// = new CMenuItem("璐?揣");
        pOrderBackImageItemList.addMouseListener(this);

        //sale
        sQuoteImageItem.addMouseListener(this);// = new CMenuItem("ヤ环");
        sQuoteImageItemList.addMouseListener(this);
        sOrderImageItem.addMouseListener(this);// = new CMenuItem("?璁㈠");
        sOrderImageItemList.addMouseListener(this);
        sSaleListImageItem.addMouseListener(this);// = new CMenuItem("?娓");
        sSaleListImageItemList.addMouseListener(this);
        sGartheringImageItem.addMouseListener(this);// = new CMenuItem("舵剧绠");
        sGartheringImageItemList.addMouseListener(this);
        sAjustPriceImageItem.addMouseListener(this);// = new CMenuItem("璋浠");
        sAjustPriceImageItemList.addMouseListener(this);
        sOrderChangedImageItem.addMouseListener(this);// = new CMenuItem("璁㈠");
        sOrderChangedImageItemList.addMouseListener(this);
        sOrderBackImageItem.addMouseListener(this);// = new CMenuItem("??揣");
        sOrderBackImageItemList.addMouseListener(this);
        //
        mPreReceivableImageItem.addMouseListener(this);// = new CMenuItem("?棰剁＄");
        mPreReceivableImageItemList.addMouseListener(this);
        mReceivableClearingImageItem.addMouseListener(this);// = new CMenuItem("舵剧绠绠＄");
        mReceivableClearingImageItemList.addMouseListener(this);
        mPrePayableImageItem.addMouseListener(this);// = new CMenuItem("璐棰浠绠＄");
        mPrePayableImageItemList.addMouseListener(this);
        mPayableClearingImageItem.addMouseListener(this);// = new CMenuItem("浠娆剧绠绠＄");
        mPayableClearingImageItemList.addMouseListener(this);

        // warehouse
        wStorageInImageItem.addMouseListener(this);
        wStorageInImageItemList.addMouseListener(this);
        wStorageOutImageItem.addMouseListener(this);
        wStorageOutImageItemList.addMouseListener(this);
        wStorageOutflowImageItem.addMouseListener(this);
        wStorageOutflowImageItemList.addMouseListener(this);
        wStorageLossImageItem.addMouseListener(this);
        wStorageLossImageItemList.addMouseListener(this);
        wStorageCheckImageItem.addMouseListener(this);
        wStorageCheckImageItemList.addMouseListener(this);
        wStorageMoveImageItem.addMouseListener(this);
        wStorageMoveImageItemList.addMouseListener(this);
        wStorageChangeMoneyImageItem.addMouseListener(this);
        wStorageChangeMoneyImageItemList.addMouseListener(this);
        wStorageMaxMinImageItem.addMouseListener(this);
        wStorageMaxMinImageItemList.addMouseListener(this);
        // produce

        // system
        sCompanyInfoImageItem.addMouseListener(this);
        sUserImageItem.addMouseListener(this);
        sLogImageItem.addMouseListener(this);
        sNumberImageItem.addMouseListener(this);
        productBaseItem.addMouseListener(this);
        storageSearchBaseItem.addMouseListener(this);//"库存查询");
        storageMinMaxBaseItem.addMouseListener(this);//"库存上下限");

        //report purchase
//    rPurchaseIndentImageItem.addMouseListener(this);
//    rPurchaseIndentProStatImageItem.addMouseListener(this);
//    rPurchaseIndentProductImageItem.addMouseListener(this);
//    rPurchaseIndentBalanceImageItem.addMouseListener(this);////跺
//    rPurchaseIndentProBalStatImageItem.addMouseListener(this);////跺
//    rPurchaseIndentProBalDetailImageItem.addMouseListener(this);////跺
//    rPurchaseIndentSupplierStatImageItem.addMouseListener(this);
//    rPurchaseIndentPersonStatImageItem.addMouseListener(this);
//    rProductPurchaseStatImageItem.addMouseListener(this);
//    rProductPurchaseDetailImageItem.addMouseListener(this);
//    rSupplierPurchaseStatImageItem.addMouseListener(this);
//    rSupplierPurchaseDetailImageItem.addMouseListener(this);
//    rEmployeePurchaseStatImageItem.addMouseListener(this);
//    rEmployeePurchaseDetailImageItem.addMouseListener(this);
//    rProductPurchaseGatherImageItem.addMouseListener(this);////跺
//    rProductPurchasePriceWaveImageItem.addMouseListener(this);////跺
//
//    //report sale
//    rSaleIndentImageItem.addMouseListener(this);
//    rSaleIndentProStatImageItem.addMouseListener(this);
//    rSaleIndentProductImageItem.addMouseListener(this);
//    rSaleIndentBalanceImageItem.addMouseListener(this);////跺
//    rSaleIndentProBalStatImageItem.addMouseListener(this);////跺
//    rSaleIndentProBalDetailImageItem.addMouseListener(this);////跺
//    rSaleIndentCustomerStatImageItem.addMouseListener(this);
//    rSaleIndentPersonStatImageItem.addMouseListener(this);
//    rCustomerMonthSaleCompareImageItem.addMouseListener(this);
//    rProductMonthSaleCompareImageItem.addMouseListener(this);
//    rCustomerSaleOrderImageItem.addMouseListener(this);
//    rProductSaleOrderImageItem.addMouseListener(this);
//    rEmployeeSaleOrderImageItem.addMouseListener(this);
//    rProductSaleStatImageItem.addMouseListener(this);
//    rProductSaleDetailImageItem.addMouseListener(this);
//    rSupplierSaleStatImageItem.addMouseListener(this);
//    rSupplierSaleDetailImageItem.addMouseListener(this);
//    rEmployeeSaleStatImageItem.addMouseListener(this);
//    rEmployeeSaleDetailImageItem.addMouseListener(this);
//    rProductSaleGatherImageItem.addMouseListener(this);
//    rProductPriceImageItem.addMouseListener(this);
//    rProductSalePriceWaveImageItem.addMouseListener(this);
//
//    //report finance
//    rSubjectBalanceImageItem.addMouseListener(this);
//    rCashBankMonthReportImageItem.addMouseListener(this);
//    rCashBankDetailImageItem.addMouseListener(this);
//    rDailyFeeReportImageItem.addMouseListener(this);
//    rDailyFeeDetailImageItem.addMouseListener(this);
//    rOtherIncomeMonthReportImageItem.addMouseListener(this);
//    rOtherIncomeDetailImageItem.addMouseListener(this);
//
//    //report balance
//    rSupplierPayBalanceImageItem.addMouseListener(this);
//    rSupplierUnbalanceDetailImageItem.addMouseListener(this);
//    rCustomerReceiveBalanceImageItem.addMouseListener(this);
//    rCustomerUnbalanceDetailImageItem.addMouseListener(this);
//    rSupplierQueryImageItem.addMouseListener(this);////跺
//    rCustomerQueryImageItem.addMouseListener(this);////跺


        storageSearchBaseItem.addMouseListener(this);  //= new CBaseImageItem(new ImageIcon(this.getClass().getResource("/resources/png/items/24/search.png")), "库存查询");
        storageMinMaxBaseItem.addMouseListener(this);  //= new CBaseImageItem(new ImageIcon(this.getClass().getResource("/resources/png/items/24/search.png")), "库存上下限");
        payableBaseItem.addMouseListener(this);  //= new CBaseImageItem(new ImageIcon(this.getClass().getResource("/resources/png/items/24/search.png")), "供应商应付未结");
        receivableBaseItem.addMouseListener(this);  //= new CBaseImageItem(new ImageIcon(this.getClass().getResource("/resources/png/items/24/search.png")), "应收未结");
        employeeSaleBaseItem.addMouseListener(this);  //= new CBaseImageItem(new ImageIcon(this.getClass().getResource("/resources/png/items/24/employee.png")), "业务员业绩");
        priceBaseItem.addMouseListener(this);  //= new CBaseImageItem(new ImageIcon(this.getClass().getResource("/resources/png/items/24/money.png")), "价格信息");

        subjectRemainBaseItem.addMouseListener(this);  //= new CBaseImageItem(new ImageIcon(this.getClass().getResource("/resources/png/items/24/money.png")), "科目余额");
        customerBaseItem.addMouseListener(this);  //= new CBaseImageItem(new ImageIcon(this.getClass().getResource("/resources/png/items/24/customer.png")), "资料");
        storageBaseItem.addMouseListener(this);  //= new CBaseImageItem(new ImageIcon(this.getClass().getResource("/resources/png/items/24/storage.png")), "仓库资料");
        subjectBaseItem.addMouseListener(this);  //= new CBaseImageItem(new ImageIcon(this.getClass().getResource("/resources/png/items/24/subject.png")), "会计科目");

        refreshBaseInfo.addMouseListener(this);  //= new CBaseImageItem(new ImageIcon(this.getClass().getResource("/resources/new/png/refresh.png")), "刷新基础信息");
        welcomePage.addMouseListener(this);  //= new CBaseImageItem(new ImageIcon(this.getClass().getResource("/resources/new/png/welcomeicon.png")), "欢迎页面");
        changePassword.addMouseListener(this);  //= new CBaseImageItem(new ImageIcon(this.getClass().getResource("/resources/new/png/key.png")), "修改密码");

        salesReportImageItem.addMouseListener(this);
        storageReportImageItem.addMouseListener(this);
        purchaseReportImageItem.addMouseListener(this);
        bankCashReportImageItem.addMouseListener(this);
        clearingImageItem.addMouseListener(this);
        initReportImageItem.addMouseListener(this);
        this.setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE);
        this.addWindowListener(new WindowAdapter() {

            public void windowClosing(WindowEvent e) {
                Main.getSystemConfig().saveSystemConfig();

                close();

            }
        });



    }

    private JPanel createTopPane() {
        JPanel pane = new JPanel();
        pane.setBackground(Color.white);
        pane.setLayout(new BorderLayout());
        CTitlePane titlePane = new CTitlePane();
        Image middleImage = null;
        try {
            middleImage = ImageIO.read(getClass().getResource("/resources/middleback.png"));
        } catch (Exception ex) {
            ex.printStackTrace();
        }
        JPanel middlePane = new CImageBackPane(middleImage);
        middlePane.setPreferredSize(new Dimension(300, 27));
        middlePane.setLayout(new BorderLayout());
        JPanel tempPane = new JPanel();
        tempPane.setPreferredSize(new Dimension(400, 27));
        middlePane.add("West", tempPane);
        tempPane.setLayout(null);
        JLabel mLabel = new JLabel("主模块", new ImageIcon(getClass().getResource("/resources/bluebutton.png")), JLabel.RIGHT);
        tempPane.add(mLabel);
        mLabel.setBounds(2, 2, 120, 25);
        mLabel.setHorizontalAlignment(JLabel.LEFT);
        mLabel = new JLabel("子功能", new ImageIcon(getClass().getResource("/resources/yellowbutton.png")), JLabel.RIGHT);
        tempPane.add(mLabel);
        mLabel.setBounds(200, 2, 120, 25);
        mLabel.setHorizontalAlignment(JLabel.LEFT);
        JPanel mp = new JPanel();
        mp.setLayout(null);
        mp.setPreferredSize(new Dimension(300, 27));
        mp.add(welcomePage);
        welcomePage.setBounds(10, 0, 80, 27);
        welcomePage.setLineVisible(false);
        mp.add(refreshBaseInfo);
        refreshBaseInfo.setBounds(95, 0, 120, 27);


        this.refreshBaseInfo.setLineVisible(false);
        middlePane.add("East", mp);//this.refreshBaseInfo);

        mp.add(changePassword);
        changePassword.setLineVisible(false);
        changePassword.setBounds(210, 0, 80, 27);
        welcomePage.addMouseListener(this);
        refreshBaseInfo.addMouseListener(this);
        changePassword.addMouseListener(this);

        pane.add("North", titlePane);
        pane.add("South", middlePane);
        return pane;
    }

    private JPanel createModulePane() {
        Image image = null;
        try {
            image = ImageIO.read(getClass().getResource("/resources/vmiddle.png"));

        } catch (Exception ex) {
            ex.printStackTrace();
        }
        JPanel pane = new JPanel();
        pane.setLayout(new BorderLayout());
        CModulePane modulePane = new CModulePane();
        pane.add("Center", modulePane);
        JPanel rPanel = new CImageBackPane(image, PaintTools.Y_SCALED);
        rPanel.setPreferredSize(new Dimension(10, 300));
        pane.add("East", rPanel);
        pane.setPreferredSize(new Dimension(200, 300));
        modulePane.setLayout(null);

        baseButton = new CNaviButton("基础设置", new ImageIcon(getClass().getResource(
                "/resources/png/32/order5.png")));
        modulePane.addButton(baseButton);
        int y = 0;
        baseButton.setBounds(0, y, 200, 40);

        initButton = new CNaviButton("系统期初", new ImageIcon(getClass().getResource(
                "/resources/png/items/begin/init.png")));
        modulePane.addButton(initButton);
        y += 40;
        initButton.setBounds(0, y, 200, 40);

        purchaseButton = new CNaviButton("采购管理", new ImageIcon(getClass().getResource(
                "/resources/png/32/order.png")));
        modulePane.addButton(purchaseButton);
        y += 40;

        purchaseButton.setBounds(0, y, 200, 40);

        saleButton = new CNaviButton("销售管理", new ImageIcon(getClass().getResource(
                "/resources/png/items/sale/sale32.png")));
        modulePane.addButton(saleButton);
        y += 40;
        saleButton.setBounds(0, y, 200, 40);

        storageButton = new CNaviButton("仓存管理", new ImageIcon(getClass().getResource(
                "/resources/png/items/storage/storage.png")));
        modulePane.addButton(storageButton);
        y += 40;
        storageButton.setBounds(0, y, 200, 40);

        clearingButton = new CNaviButton("应收应付", new ImageIcon(getClass().getResource(
                "/resources/png/32/22.png")));
        modulePane.addButton(clearingButton);
        y += 40;
        clearingButton.setBounds(0, y, 200, 40);

        bankCashButton = new CNaviButton("财务管理", new ImageIcon(getClass().getResource(
                "/resources/png/32/23.png")));
        modulePane.addButton(bankCashButton);
        y += 40;
        bankCashButton.setBounds(0, y, 200, 40);

        reportButton = new CNaviButton("报表查询", new ImageIcon(getClass().getResource(
                "/resources/png/items/report/report.png")));
        modulePane.addButton(reportButton);
        y += 40;
        reportButton.setBounds(0, y, 200, 40);

        managerButton = new CNaviButton("老板查询", new ImageIcon(getClass().getResource(
                "/resources/png/32/chart5.png")));
        modulePane.addButton(managerButton);
        y += 70;
        managerButton.setBounds(0, y, 200, 40);
        purchaseButton.addMouseListener(this);
        saleButton.addMouseListener(this);
        storageButton.addMouseListener(this);
        clearingButton.addMouseListener(this);
        bankCashButton.addMouseListener(this);
        reportButton.addMouseListener(this);
        managerButton.addMouseListener(this);
        this.baseButton.addMouseListener(this);
        this.initButton.addMouseListener(this);

        return pane;
    }

    private JPanel createClientPane() {
        Image image = null;
        try {
            image = ImageIO.read(getClass().getResource("/resources/mainBack.png"));
        } catch (Exception ex) {
            ex.printStackTrace();
        }
        JPanel pane = new CImageBackPane(image, PaintTools.X_SCALED);
        return pane;

    }

    protected void loadStatusBar() {
        this.statusBar = new CStatusBar();
        this.getContentPane().add("South", this.statusBar);
        //this.statusBar.addText("褰ㄦ:绠＄?, 5, 160);
        statusBar.addText("XXXX ", 500, 500);
    }

    private static void installDefaults() {
        UIManager.getDefaults().put("menu.font", new Font("宋体", Font.PLAIN, 12));
        UIManager.getDefaults().put("required.background", new Color(255, 255, 204));
        UIManager.getDefaults().put("Table.gridColor", new Color(103, 103, 103));
        UIManager.getDefaults().put("Tree.hash", new Color(103, 103, 103));

        try {

            UIManager.setLookAndFeel("com.birosoft.liquid.LiquidLookAndFeel");

        //UIManager.setLookAndFeel("org.fife.plaf.Office2003.Office2003LookAndFeel");
        //UIManager.setLookAndFeel("org.fife.plaf.OfficeXP.OfficeXPLookAndFeel");
        //UIManager.setLookAndFeel("org.fife.plaf.VisualStudio2005.VisualStudio2005LookAndFeel");
        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public static void main(String args[]) {
        installDefaults();
        new MainFrame().setVisible(true);
    }

    private ImageIcon getFileIcon(String name) {
        return new ImageIcon(this.getClass().getResource("/resources/png/items/" + name));
    }

    private void initPanels() {
//        Image bgImage = null;
//        try
//        {
//            bgImage = ImageIO.read(this.getClass().getResource("/resources/new/png/welcome.png"));
//        }
//        catch(Exception ex)
//        {
//            ex.printStackTrace();
//        }
        welcomePanel = new JPanel();//CImageBackPane(bgImage, PaintTools.SCALED);
        JLabel flowPic = new JLabel(new ImageIcon(this.getClass().getResource("/resources/welcome.png")));
        welcomePanel.setSize(750, 560);
        welcomePanel.setLayout(null);
        welcomePanel.add(flowPic);
        flowPic.setBounds(5, 15, 730, 530);
        this.clientPanel.add(welcomePanel);
        this.basePanel = new JPanel();// , image);
        this.basePanel.setSize(750, 400);
        this.basePanel.setLayout(null);
        productImageItem = new CImageItem(this.getFileIcon("base/product2.png"), "商品信息");
        this.basePanel.add(productImageItem);
        int x = 5;
        int y = 10;
        productImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());
        customerImageItem = new CImageItem(this.getFileIcon("/base/customer.png"), "客户信息");
        this.basePanel.add(customerImageItem);
        x += 150;
        customerImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());
        employeeImageItem = new CImageItem(this.getFileIcon("base/employee.png"), "员工信息");
        this.basePanel.add(employeeImageItem);
        x += 150;
        employeeImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());
        storageImageItem = new CImageItem(this.getFileIcon("base/storage.png"), "仓库信息");
        this.basePanel.add(storageImageItem);
        x += 150;
        storageImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());

        subjectImageItem = new CImageItem(this.getFileIcon("base/subject.png"), "会计科目");
        this.basePanel.add(subjectImageItem);
        x += 150;
        subjectImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());

        sCompanyInfoImageItem = new CImageItem(this.getFileIcon("base/company.png"), "公司信息");
        this.basePanel.add(sCompanyInfoImageItem);
        x = 5;
        y += 150;
        sCompanyInfoImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());

        sUserImageItem = new CImageItem(this.getFileIcon("/base/user.png"), "用户管理");
        this.basePanel.add(sUserImageItem);
        x += 150;
        sUserImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());
        sAccountOptionItem = new CImageItem(this.getFileIcon("base/options.png"), "套帐选项");
        this.basePanel.add(sAccountOptionItem);
        x += 150;
        sAccountOptionItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());

        sNumberImageItem = new CImageItem(this.getFileIcon("base/number.png"), "编号管理");
        this.basePanel.add(sNumberImageItem);
        x += 150;
        sNumberImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());

        sLogImageItem = new CImageItem(this.getFileIcon("base/log.png"), "系统日志");
        this.basePanel.add(sLogImageItem);
        x += 150;
        sLogImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());
        this.clientPanel.add(basePanel);


        x = 50;
        y = 10;
        this.purchasePanel = new JPanel();// , image);
        this.purchasePanel.setSize(750, 400);
        this.purchasePanel.setLayout(null);
        pOrderImageItem = new CImageItem(this.getFileIcon("purchase/purchase_order.png"), "采购订单");
        this.purchasePanel.add(pOrderImageItem);
        pOrderImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());

        pOrderImageItemList = new CLittleImageItem();
        this.purchasePanel.add(pOrderImageItemList);
        pOrderImageItemList.setBounds(x + 100, y, 30, 48);

        JLabel arrow = new JLabel(this.arrowRightIcon);
        this.purchasePanel.add(arrow);
        arrow.setBounds(x + 150, y + 25, 50, 50);

        arrow = new JLabel(this.arrowDownIcon);
        this.purchasePanel.add(arrow);
        arrow.setBounds(x + 25, y + 90, 50, 50);

        pPurchaseImageItem = new CImageItem(this.getFileIcon("purchase/purchase_list.png"), "采购单");
        this.purchasePanel.add(pPurchaseImageItem);
        x += 240;
        pPurchaseImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());
        arrow = new JLabel(this.arrowRightIcon);
        this.purchasePanel.add(arrow);
        arrow.setBounds(x + 150, y + 25, 50, 50);

        arrow = new JLabel(this.arrowUpIcon);
        this.purchasePanel.add(arrow);
        arrow.setBounds(x + 25, y + 90, 50, 50);


        pPurchaseImageItemList = new CLittleImageItem();
        this.purchasePanel.add(pPurchaseImageItemList);
        pPurchaseImageItemList.setBounds(x + 100, y, 30, 48);

        pPaymentImageItem = new CImageItem(this.getFileIcon("clearing/payclearing.png"), "付款结算");
        this.purchasePanel.add(pPaymentImageItem);
        x += 240;
        pPaymentImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());
        pPaymentImageItemList = new CLittleImageItem();
        this.purchasePanel.add(pPaymentImageItemList);
        pPaymentImageItemList.setBounds(x + 100, y, 30, 48);


        pOrderChangedImageItem = new CImageItem(this.getFileIcon("purchase/purchase_change.png"), "订单变更");
        this.purchasePanel.add(pOrderChangedImageItem);
        x = 50;
        y += 150;
        pOrderChangedImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());

        pOrderChangedImageItemList = new CLittleImageItem();
        this.purchasePanel.add(pOrderChangedImageItemList);
        pOrderChangedImageItemList.setBounds(x + 100, y, 30, 48);

        pOrderBackImageItem = new CImageItem(this.getFileIcon("purchase/purchase_back.png"), "采购退货");
        this.purchasePanel.add(pOrderBackImageItem);
        x += 240;
        pOrderBackImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());
        this.clientPanel.add(purchasePanel);
        pOrderBackImageItemList = new CLittleImageItem();
        this.purchasePanel.add(pOrderBackImageItemList);
        pOrderBackImageItemList.setBounds(x + 100, y, 30, 48);

//
        x = 30;
        y = 10;
        this.salePanel = new JPanel();// , image);
        this.salePanel.setSize(750, 400);
        this.salePanel.setLayout(null);
        sQuoteImageItem = new CImageItem(this.getFileIcon("sale/quote.png"), "商品报价");
        this.salePanel.add(sQuoteImageItem);
        sQuoteImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());

        sQuoteImageItemList = new CLittleImageItem();
        this.salePanel.add(sQuoteImageItemList);
        sQuoteImageItemList.setBounds(x + 100, y, 30, 48);

        arrow = new JLabel(this.arrowRightIcon);
        this.salePanel.add(arrow);
        arrow.setBounds(x + 130, y + 25, 50, 50);

        sOrderImageItem = new CImageItem(this.getFileIcon("sale/sale_order.png"), "销售订单");
        this.salePanel.add(sOrderImageItem);
        x += 180;
        sOrderImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());

        arrow = new JLabel(this.arrowRightIcon);
        this.salePanel.add(arrow);
        arrow.setBounds(x + 130, y + 25, 50, 50);

        arrow = new JLabel(this.arrowDownIcon);
        this.salePanel.add(arrow);
        arrow.setBounds(x + 25, y + 90, 50, 50);


        sOrderImageItemList = new CLittleImageItem();
        this.salePanel.add(sOrderImageItemList);
        sOrderImageItemList.setBounds(x + 100, y, 30, 48);

        sSaleListImageItem = new CImageItem(this.getFileIcon("sale/sale_list.png"), "销售单");
        this.salePanel.add(sSaleListImageItem);
        x += 180;
        sSaleListImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());

        arrow = new JLabel(this.arrowRightIcon);
        this.salePanel.add(arrow);
        arrow.setBounds(x + 130, y + 25, 50, 50);

        arrow = new JLabel(this.arrowDownIcon);
        this.salePanel.add(arrow);
        arrow.setBounds(x + 25, y + 90, 50, 50);


        sSaleListImageItemList = new CLittleImageItem();
        this.salePanel.add(sSaleListImageItemList);
        sSaleListImageItemList.setBounds(x + 100, y, 30, 48);

        sGartheringImageItem = new CImageItem(this.getFileIcon("clearing/receiveclearing.png"), "付款结算");
        this.salePanel.add(sGartheringImageItem);
        x += 180;
        sGartheringImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());
        sGartheringImageItemList = new CLittleImageItem();
        this.salePanel.add(sGartheringImageItemList);
        sGartheringImageItemList.setBounds(x + 100, y, 30, 48);


        sAjustPriceImageItem = new CImageItem(this.getFileIcon("sale/change_money.png"), "商品调价");
        this.salePanel.add(sAjustPriceImageItem);
        x = 30;
        y += 150;
        sAjustPriceImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());

        sAjustPriceImageItemList = new CLittleImageItem();
        this.salePanel.add(sAjustPriceImageItemList);
        sAjustPriceImageItemList.setBounds(x + 100, y, 30, 48);

        sOrderChangedImageItem = new CImageItem(this.getFileIcon("sale/sale_change.png"), "订单变更");
        this.salePanel.add(sOrderChangedImageItem);
        x += 180;
        sOrderChangedImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());
        this.clientPanel.add(salePanel);
        sOrderChangedImageItemList = new CLittleImageItem();
        this.salePanel.add(sOrderChangedImageItemList);
        sOrderChangedImageItemList.setBounds(x + 100, y, 30, 48);

        sOrderBackImageItem = new CImageItem(this.getFileIcon("sale/sale_back.png"), "销售退货");
        this.salePanel.add(sOrderBackImageItem);
        x += 180;
        sOrderBackImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());
        this.clientPanel.add(salePanel);
        sOrderBackImageItemList = new CLittleImageItem();
        this.salePanel.add(sOrderBackImageItemList);
        sOrderBackImageItemList.setBounds(x + 100, y, 30, 48);



        this.initPanel = new JPanel();


        x = 30;
        y = 10;
        storagePanel = new JPanel();// , image);
        this.storagePanel.setSize(750, 400);
        this.storagePanel.setLayout(null);
        wStorageInImageItem = new CImageItem(this.getFileIcon("storage/instorage.png"), "商品入库");
        this.storagePanel.add(wStorageInImageItem);
        wStorageInImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());

        wStorageInImageItemList = new CLittleImageItem();
        this.storagePanel.add(wStorageInImageItemList);
        wStorageInImageItemList.setBounds(x + 100, y, 30, 48);



        wStorageOutImageItem = new CImageItem(this.getFileIcon("storage/outstorage.png"), "商品出库");
        this.storagePanel.add(wStorageOutImageItem);
        x += 180;
        wStorageOutImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());
        wStorageOutImageItemList = new CLittleImageItem();
        this.storagePanel.add(wStorageOutImageItemList);
        wStorageOutImageItemList.setBounds(x + 100, y, 30, 48);


        wStorageOutflowImageItem = new CImageItem(this.getFileIcon("storage/outflow.png"), "库存报溢");
        this.storagePanel.add(wStorageOutflowImageItem);
        x += 180;
        wStorageOutflowImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());


        wStorageOutflowImageItemList = new CLittleImageItem();
        this.storagePanel.add(wStorageOutflowImageItemList);
        wStorageOutflowImageItemList.setBounds(x + 100, y, 30, 48);


        wStorageLossImageItem = new CImageItem(this.getFileIcon("storage/storage_loss.png"), "库存报损");
        this.storagePanel.add(wStorageLossImageItem);
        x += 180;
        wStorageLossImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());
        wStorageLossImageItemList = new CLittleImageItem();
        this.storagePanel.add(wStorageLossImageItemList);
        wStorageLossImageItemList.setBounds(x + 100, y, 30, 48);


        wStorageCheckImageItem = new CImageItem(this.getFileIcon("storage/storage_check.png"), "库存盘点");
        this.storagePanel.add(wStorageCheckImageItem);
        x = 30;
        y += 150;
        wStorageCheckImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());

        wStorageCheckImageItemList = new CLittleImageItem();
        this.storagePanel.add(wStorageCheckImageItemList);
        wStorageCheckImageItemList.setBounds(x + 100, y, 30, 48);

        wStorageMoveImageItem = new CImageItem(this.getFileIcon("storage/move_storage.png"), "移库管理");
        this.storagePanel.add(wStorageMoveImageItem);
        x += 180;
        wStorageMoveImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());
        this.clientPanel.add(storagePanel);
        wStorageMoveImageItemList = new CLittleImageItem();
        this.storagePanel.add(wStorageMoveImageItemList);
        wStorageMoveImageItemList.setBounds(x + 100, y, 30, 48);

        wStorageChangeMoneyImageItem = new CImageItem(this.getFileIcon("storage/storage_money.png"), "库存变价");
        this.storagePanel.add(wStorageChangeMoneyImageItem);
        x += 180;
        wStorageChangeMoneyImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());
        wStorageChangeMoneyImageItemList = new CLittleImageItem();
        this.storagePanel.add(wStorageChangeMoneyImageItemList);
        wStorageChangeMoneyImageItemList.setBounds(x + 100, y, 30, 48);

        wStorageMaxMinImageItem = new CImageItem(this.getFileIcon("storage/storage_updown.png"), "库存上下限");
        this.storagePanel.add(wStorageMaxMinImageItem);
        x += 180;
        wStorageMaxMinImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());

        wStorageMaxMinImageItemList = new CLittleImageItem();
        this.storagePanel.add(wStorageMaxMinImageItemList);
        wStorageMaxMinImageItemList.setBounds(x + 100, y, 30, 48);
        this.clientPanel.add(storagePanel);
        /*//
        this.outStoragePanel = new CGridItemPane(2, 4);


        // ....

        //
        this.checkStoragePanel = new CGridItemPane(2, 4);
         */
        // ....

        // ....

        //
        this.systemPanel = new JPanel();

        x = 150;
        y = 10;
        this.clearingPanel = new JPanel();// , image);
        this.clearingPanel.setSize(750, 400);
        this.clearingPanel.setLayout(null);
        mPreReceivableImageItem = new CImageItem(this.getFileIcon("clearing/prereceive.png"), "预收款单");
        this.clearingPanel.add(mPreReceivableImageItem);
        mPreReceivableImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());

        mPreReceivableImageItemList = new CLittleImageItem();
        this.clearingPanel.add(mPreReceivableImageItemList);
        mPreReceivableImageItemList.setBounds(x + 100, y, 30, 48);

        arrow = new JLabel(this.arrowRightIcon);
        this.clearingPanel.add(arrow);
        arrow.setBounds(x + 150, y + 25, 50, 50);


        mReceivableClearingImageItem = new CImageItem(this.getFileIcon("clearing/receiveclearing.png"), "收款结算");
        this.clearingPanel.add(mReceivableClearingImageItem);
        x += 240;
        mReceivableClearingImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());


        mReceivableClearingImageItemList = new CLittleImageItem();
        this.clearingPanel.add(mReceivableClearingImageItemList);
        mReceivableClearingImageItemList.setBounds(x + 100, y, 30, 48);


        mPrePayableImageItem = new CImageItem(this.getFileIcon("clearing/prepay.png"), "预付款单");
        this.clearingPanel.add(mPrePayableImageItem);
        x = 150;
        y += 150;
        mPrePayableImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());
        mPrePayableImageItemList = new CLittleImageItem();
        this.clearingPanel.add(mPrePayableImageItemList);
        mPrePayableImageItemList.setBounds(x + 100, y, 30, 48);

        arrow = new JLabel(this.arrowRightIcon);
        this.clearingPanel.add(arrow);
        arrow.setBounds(x + 150, y + 25, 50, 50);

        mPayableClearingImageItem = new CImageItem(this.getFileIcon("clearing/payclearing.png"), "付款结算");
        this.clearingPanel.add(mPayableClearingImageItem);
        x += 240;

        mPayableClearingImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());

        mPayableClearingImageItemList = new CLittleImageItem();
        this.clearingPanel.add(mPayableClearingImageItemList);
        mPayableClearingImageItemList.setBounds(x + 100, y, 30, 48);


        this.clientPanel.add(clearingPanel);
        // ....
        x = 150;
        y = 10;
        this.bankCashPanel = new JPanel();// , image);
        this.bankCashPanel.setSize(750, 400);
        this.bankCashPanel.setLayout(null);
        mBussinessExpenseImageItem = new CImageItem(this.getFileIcon("clearing/prereceive.png"), "经营费用");
        this.bankCashPanel.add(mBussinessExpenseImageItem);
        mBussinessExpenseImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());

        mBussinessExpenseImageItemList = new CLittleImageItem();
        this.bankCashPanel.add(mBussinessExpenseImageItemList);
        mBussinessExpenseImageItemList.setBounds(x + 100, y, 30, 48);

        mCommonExpenseImageItem = new CImageItem(this.getFileIcon("clearing/receiveclearing.png"), "一般费用");
        this.bankCashPanel.add(mCommonExpenseImageItem);
        x += 240;
        mCommonExpenseImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());


        mCommonExpenseImageItemList = new CLittleImageItem();
        this.bankCashPanel.add(mCommonExpenseImageItemList);
        mCommonExpenseImageItemList.setBounds(x + 100, y, 30, 48);


        mOtherIncomeImageItem = new CImageItem(this.getFileIcon("clearing/prepay.png"), "其它收入");
        this.bankCashPanel.add(mOtherIncomeImageItem);
        x = 150;
        y += 150;
        mOtherIncomeImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());
        mOtherIncomeImageItemList = new CLittleImageItem();
        this.bankCashPanel.add(mOtherIncomeImageItemList);
        mOtherIncomeImageItemList.setBounds(x + 100, y, 30, 48);



        mBankCashImageItem = new CImageItem(this.getFileIcon("clearing/payclearing.png"), "现金银行");
        this.bankCashPanel.add(mBankCashImageItem);
        x += 240;

        mBankCashImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());

        mBankCashImageItemList = new CLittleImageItem();
        this.bankCashPanel.add(mBankCashImageItemList);
        mBankCashImageItemList.setBounds(x + 100, y, 30, 48);


        this.clientPanel.add(bankCashPanel);

        x = 150;
        y = 10;
        this.initPanel = new JPanel();// , image);
        this.initPanel.setSize(750, 400);
        this.initPanel.setLayout(null);
        fStorageBeginManageImageItem = new CImageItem(this.getFileIcon("begin/storage.png"), "库存期初");
        this.initPanel.add(fStorageBeginManageImageItem);
        fStorageBeginManageImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());

        fStorageBeginManageImageItemList = new CLittleImageItem();
        this.initPanel.add(fStorageBeginManageImageItemList);
        fStorageBeginManageImageItemList.setBounds(x + 100, y, 30, 48);


        bSubjectBeginManageImageItem = new CImageItem(this.getFileIcon("begin/subject.png"), "会计科目期初");
        this.initPanel.add(bSubjectBeginManageImageItem);
        x += 240;
        bSubjectBeginManageImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());


        bSubjectBeginManageImageItemList = new CLittleImageItem();
        this.initPanel.add(bSubjectBeginManageImageItemList);
        bSubjectBeginManageImageItemList.setBounds(x + 100, y, 30, 48);


        bReceivableBeginMangeImageItem = new CImageItem(this.getFileIcon("begin/receive.png"), "应收款期初");
        this.initPanel.add(bReceivableBeginMangeImageItem);
        x = 150;
        y += 150;
        bReceivableBeginMangeImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());
        bReceivableBeginMangeImageItemList = new CLittleImageItem();
        this.initPanel.add(bReceivableBeginMangeImageItemList);
        bReceivableBeginMangeImageItemList.setBounds(x + 100, y, 30, 48);


        bPaymentBeginManageImageItem = new CImageItem(this.getFileIcon("begin/pay.png"), "应付款期初");
        this.initPanel.add(bPaymentBeginManageImageItem);
        x += 240;

        bPaymentBeginManageImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());

        bPaymentBeginManageImageItemList = new CLittleImageItem();
        this.initPanel.add(bPaymentBeginManageImageItemList);
        bPaymentBeginManageImageItemList.setBounds(x + 100, y, 30, 48);


        this.clientPanel.add(initPanel);

        //

        x = 60;
        y = 10;

        this.reportPanel = new JPanel();// , image);
        this.reportPanel.setSize(750, 400);
        this.reportPanel.setLayout(null);

        purchaseReportImageItem = new CImageItem(this.getFileIcon("purchase/purchase_list.png"), "采购报表");
        this.reportPanel.add(purchaseReportImageItem);
        x += 150;
        y += 100;
        purchaseReportImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());
        storageReportImageItem = new CImageItem(this.getFileIcon("purchase/purchase_list.png"), "仓库报表");
        this.reportPanel.add(storageReportImageItem);
        x += 150;
        storageReportImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());
        salesReportImageItem = new CImageItem(this.getFileIcon("purchase/purchase_list.png"), "销售报表");
        this.reportPanel.add(salesReportImageItem);
        x += 150;
        salesReportImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());


        bankCashReportImageItem = new CImageItem(this.getFileIcon("purchase/purchase_list.png"), "财务报表");
        this.reportPanel.add(bankCashReportImageItem);
        x = 60;
        x += 150;
        y += 150;
        bankCashReportImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());
        clearingImageItem = new CImageItem(this.getFileIcon("purchase/purchase_list.png"), "结算报表");
        this.reportPanel.add(clearingImageItem);
        x += 150;
        clearingImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());

        initReportImageItem = new CImageItem(this.getFileIcon("purchase/purchase_list.png"), "综合报表");
        this.reportPanel.add(initReportImageItem);
        x += 150;
        initReportImageItem.setBounds(x, y, productImageItem.getWidth(), productImageItem.getHeight());



        this.clientPanel.add(reportPanel);


        this.createBaseInfo();

    }

    private void createBaseInfo() {
        this.bPanel = new CGroupPane("相关资料");
        this.bPanel.setSize(750, 80);
        this.clientPanel.add(this.bPanel);
        this.bPanel.setVisible(false);
        this.bPanel.setLayout(null);
        this.bPanel.add(productBaseItem);
        this.bPanel.add(storageSearchBaseItem);
        this.bPanel.add(storageMinMaxBaseItem);
        this.bPanel.add(payableBaseItem);
        this.bPanel.add(receivableBaseItem);
        this.bPanel.add(employeeSaleBaseItem);
        this.bPanel.add(priceBaseItem);
        this.bPanel.add(subjectRemainBaseItem);
        this.bPanel.add(customerBaseItem);
        this.bPanel.add(storageBaseItem);
        this.bPanel.add(subjectBaseItem);

    //productBaseItem.setBounds(10, 30, productBaseItem.getWidth(), productBaseItem.getHeight());
    }

    private void showInitPane() {

        hideAllPane();
        this.initPanel.setVisible(true);
        Rectangle rect = this.clientPanel.getBounds();
        this.initPanel.setBounds((rect.width - this.initPanel.getWidth()) / 2, (rect.height - this.initPanel.getHeight()) / 2, this.initPanel.getWidth(), this.basePanel.getHeight());
        this.helpPane.setHelpInfo("   期初...");
        this.helpPane.setBounds((rect.width - helpPane.getWidth()) / 2, rect.height - this.helpPane.getHeight(), helpPane.getWidth(), helpPane.getHeight());
        //base info
        this.hideAllBaseButtons();
        this.bPanel.setVisible(true);
        this.bPanel.setBounds((rect.width - bPanel.getWidth()) / 2, rect.height - 150, bPanel.getWidth(), bPanel.getHeight());
        storageSearchBaseItem.setVisible(true);
        storageMinMaxBaseItem.setVisible(true);
        payableBaseItem.setVisible(true);
        receivableBaseItem.setVisible(true);
        employeeSaleBaseItem.setVisible(true);
        priceBaseItem.setVisible(true);
        int x = 10;
        int y = 30;
        storageSearchBaseItem.setLocation(x, y);
        x += storageSearchBaseItem.getWidth() + 10;
        storageMinMaxBaseItem.setLocation(x, y);
        x += storageMinMaxBaseItem.getWidth() + 10;
        payableBaseItem.setLocation(x, y);
        x += payableBaseItem.getWidth() + 10;
        receivableBaseItem.setLocation(x, y);
        x += receivableBaseItem.getWidth() + 10;
        employeeSaleBaseItem.setLocation(x, y);
        x += employeeSaleBaseItem.getWidth() + 10;
        priceBaseItem.setLocation(x, y);
    }

    private void showBasePane() {
        hideAllPane();
        this.basePanel.setVisible(true);
        Rectangle rect = this.clientPanel.getBounds();
        this.basePanel.setBounds((rect.width - this.basePanel.getWidth()) / 2, (rect.height - this.basePanel.getHeight()) / 2, this.basePanel.getWidth(), this.basePanel.getHeight());
        this.helpPane.setHelpInfo("   基础信息...");
        this.helpPane.setBounds((rect.width - helpPane.getWidth()) / 2, rect.height - this.helpPane.getHeight(), helpPane.getWidth(), helpPane.getHeight());
        //base info
        this.hideAllBaseButtons();
        this.bPanel.setVisible(true);
        this.bPanel.setBounds((rect.width - bPanel.getWidth()) / 2, rect.height - 150, bPanel.getWidth(), bPanel.getHeight());
        storageSearchBaseItem.setVisible(true);
        storageMinMaxBaseItem.setVisible(true);
        payableBaseItem.setVisible(true);
        receivableBaseItem.setVisible(true);
        employeeSaleBaseItem.setVisible(true);
        priceBaseItem.setVisible(true);
        int x = 10;
        int y = 30;
        storageSearchBaseItem.setLocation(x, y);
        x += storageSearchBaseItem.getWidth() + 10;
        storageMinMaxBaseItem.setLocation(x, y);
        x += storageMinMaxBaseItem.getWidth() + 10;
        payableBaseItem.setLocation(x, y);
        x += payableBaseItem.getWidth() + 10;
        receivableBaseItem.setLocation(x, y);
        x += receivableBaseItem.getWidth() + 10;
        employeeSaleBaseItem.setLocation(x, y);
        x += employeeSaleBaseItem.getWidth() + 10;
        priceBaseItem.setLocation(x, y);

    //productBaseItem.setBounds(10, 30, productBaseItem.getWidth(), productBaseItem.getHeight());

    }

    private void showWelcomePane() {
        hideAllPane();
        welcomePanel.setVisible(true);
        Rectangle rect = this.clientPanel.getBounds();
        this.welcomePanel.setBounds((rect.width - this.welcomePanel.getWidth()) / 2, (rect.height - this.welcomePanel.getHeight()) / 2, this.welcomePanel.getWidth(), this.welcomePanel.getHeight());
        this.hideAllBaseButtons();
        this.bPanel.setVisible(false);
        this.helpPane.setVisible(false);


    }

    private void showPurchasePane() {
        hideAllPane();
        this.purchasePanel.setVisible(true);
        Rectangle rect = this.clientPanel.getBounds();
        this.purchasePanel.setBounds((rect.width - this.purchasePanel.getWidth()) / 2, (rect.height - this.purchasePanel.getHeight()) / 2, this.purchasePanel.getWidth(), this.purchasePanel.getHeight());
        this.bPanel.setVisible(true);
        this.bPanel.setBounds((rect.width - bPanel.getWidth()) / 2, rect.height - 150, bPanel.getWidth(), bPanel.getHeight());
        this.helpPane.setHelpInfo("   采购管理");
        this.helpPane.setBounds((rect.width - helpPane.getWidth()) / 2, rect.height - this.helpPane.getHeight(), helpPane.getWidth(), helpPane.getHeight());
        this.helpPane.setVisible(true);
        this.hideAllBaseButtons();

        this.bPanel.setVisible(true);
        productBaseItem.setVisible(true);
        customerBaseItem.setVisible(true);
        storageBaseItem.setVisible(true);
        storageSearchBaseItem.setVisible(true);
        payableBaseItem.setVisible(true);
        int x = 10;
        int y = 30;
        productBaseItem.setLocation(x, y);
        x += productBaseItem.getWidth() + 10;
        customerBaseItem.setLocation(x, y);
        x += customerBaseItem.getWidth() + 10;
        storageBaseItem.setLocation(x, y);
        x += storageBaseItem.getWidth() + 10;
        storageSearchBaseItem.setLocation(x, y);
        x += storageSearchBaseItem.getWidth() + 10;
        payableBaseItem.setLocation(x, y);

    }

    private void showSalePane() {
        hideAllPane();
        this.salePanel.setVisible(true);
        Rectangle rect = this.clientPanel.getBounds();
        this.salePanel.setBounds((rect.width - this.purchasePanel.getWidth()) / 2, (rect.height - this.purchasePanel.getHeight()) / 2, this.purchasePanel.getWidth(), this.purchasePanel.getHeight());
        this.helpPane.setHelpInfo("   销售管理");
        this.helpPane.setBounds((rect.width - helpPane.getWidth()) / 2, rect.height - this.helpPane.getHeight(), helpPane.getWidth(), helpPane.getHeight());
        this.helpPane.setVisible(true);
        this.hideAllBaseButtons();
        this.bPanel.setVisible(true);

        productBaseItem.setVisible(true);
        customerBaseItem.setVisible(true);
        storageBaseItem.setVisible(true);
        storageSearchBaseItem.setVisible(true);
        receivableBaseItem.setVisible(true);
        priceBaseItem.setVisible(true);
        int x = 10;
        int y = 30;
        productBaseItem.setLocation(x, y);
        x += productBaseItem.getWidth() + 10;
        customerBaseItem.setLocation(x, y);
        x += customerBaseItem.getWidth() + 10;
        storageBaseItem.setLocation(x, y);
        x += storageBaseItem.getWidth() + 10;
        storageSearchBaseItem.setLocation(x, y);
        x += storageSearchBaseItem.getWidth() + 10;
        receivableBaseItem.setLocation(x, y);
        x += receivableBaseItem.getWidth() + 10;
        priceBaseItem.setLocation(x, y);
        this.bPanel.setBounds((rect.width - bPanel.getWidth()) / 2, rect.height - 150, bPanel.getWidth(), bPanel.getHeight());



    }

    private void showStoragePane() {
        hideAllPane();
        this.storagePanel.setVisible(true);
        Rectangle rect = this.clientPanel.getBounds();
        this.storagePanel.setBounds((rect.width - this.purchasePanel.getWidth()) / 2, (rect.height - this.purchasePanel.getHeight()) / 2, this.purchasePanel.getWidth(), this.purchasePanel.getHeight());
        this.helpPane.setHelpInfo("   仓存管理..");
        this.helpPane.setBounds((rect.width - helpPane.getWidth()) / 2, rect.height - this.helpPane.getHeight(), helpPane.getWidth(), helpPane.getHeight());
        this.helpPane.setVisible(true);
        this.hideAllBaseButtons();
        this.bPanel.setVisible(true);
        productBaseItem.setVisible(true);
        storageBaseItem.setVisible(true);
        storageSearchBaseItem.setVisible(true);

        int x = 10;
        int y = 30;
        productBaseItem.setLocation(x, y);
        x += productBaseItem.getWidth() + 10;
        storageBaseItem.setLocation(x, y);
        x += storageBaseItem.getWidth() + 10;
        storageSearchBaseItem.setLocation(x, y);
        this.bPanel.setBounds((rect.width - bPanel.getWidth()) / 2, rect.height - 150, bPanel.getWidth(), bPanel.getHeight());


    }

    private void showClearingPane() {
        hideAllPane();
        this.clearingPanel.setVisible(true);
        Rectangle rect = this.clientPanel.getBounds();
        this.clearingPanel.setBounds((rect.width - this.purchasePanel.getWidth()) / 2, (rect.height - this.purchasePanel.getHeight()) / 2, this.purchasePanel.getWidth(), this.purchasePanel.getHeight());
        this.helpPane.setHelpInfo("   结算管理");
        this.helpPane.setBounds((rect.width - helpPane.getWidth()) / 2, rect.height - this.helpPane.getHeight(), helpPane.getWidth(), helpPane.getHeight());
        this.helpPane.setVisible(true);
        this.hideAllBaseButtons();
        this.bPanel.setVisible(true);

        this.customerBaseItem.setVisible(true);
        this.payableBaseItem.setVisible(true);
        this.receivableBaseItem.setVisible(true);


        int x = 10;
        int y = 30;
        customerBaseItem.setLocation(x, y);
        x += customerBaseItem.getWidth() + 10;

        payableBaseItem.setLocation(x, y);
        x += payableBaseItem.getWidth() + 10;
        receivableBaseItem.setLocation(x, y);

        this.bPanel.setBounds((rect.width - bPanel.getWidth()) / 2, rect.height - 150, bPanel.getWidth(), bPanel.getHeight());


    }

    private void showBankCashPane() {
        hideAllPane();
        bankCashPanel.setVisible(true);

        Rectangle rect = this.clientPanel.getBounds();
        this.bankCashPanel.setBounds((rect.width - this.purchasePanel.getWidth()) / 2, (rect.height - this.purchasePanel.getHeight()) / 2, this.purchasePanel.getWidth(), this.purchasePanel.getHeight());
        this.helpPane.setHelpInfo("   资金管理...");
        this.helpPane.setBounds((rect.width - helpPane.getWidth()) / 2, rect.height - this.helpPane.getHeight(), helpPane.getWidth(), helpPane.getHeight());
        this.helpPane.setVisible(true);
        this.hideAllBaseButtons();
        this.bPanel.setVisible(true);

        this.customerBaseItem.setVisible(true);
        this.payableBaseItem.setVisible(true);
        this.receivableBaseItem.setVisible(true);


        int x = 10;
        int y = 30;
        customerBaseItem.setLocation(x, y);
        x += customerBaseItem.getWidth() + 10;

        payableBaseItem.setLocation(x, y);
        x += payableBaseItem.getWidth() + 10;
        receivableBaseItem.setLocation(x, y);

        this.bPanel.setBounds((rect.width - bPanel.getWidth()) / 2, rect.height - 150, bPanel.getWidth(), bPanel.getHeight());


    }

    private void showManagerPane() {
        hideAllPane();
        this.bPanel.setVisible(false);
        this.helpPane.setVisible(false);
    }

    private void showReportPane() {
        hideAllPane();
        reportPanel.setVisible(true);
        Rectangle rect = this.clientPanel.getBounds();
        this.salePanel.setBounds((rect.width - this.purchasePanel.getWidth()) / 2, (rect.height - this.purchasePanel.getHeight()) / 2, this.purchasePanel.getWidth(), this.purchasePanel.getHeight());
        this.helpPane.setHelpInfo("   报表中心");
        this.helpPane.setBounds((rect.width - helpPane.getWidth()) / 2, rect.height - this.helpPane.getHeight(), helpPane.getWidth(), helpPane.getHeight());
        this.helpPane.setVisible(true);
        this.hideAllBaseButtons();
        this.bPanel.setVisible(true);
        productBaseItem.setVisible(true);
        customerBaseItem.setVisible(true);
        storageBaseItem.setVisible(true);
        storageSearchBaseItem.setVisible(true);
        receivableBaseItem.setVisible(true);
        priceBaseItem.setVisible(true);
        int x = 10;
        int y = 30;
        productBaseItem.setLocation(x, y);
        x += productBaseItem.getWidth() + 10;
        customerBaseItem.setLocation(x, y);
        x += customerBaseItem.getWidth() + 10;
        storageBaseItem.setLocation(x, y);
        x += storageBaseItem.getWidth() + 10;
        storageSearchBaseItem.setLocation(x, y);
        x += storageSearchBaseItem.getWidth() + 10;
        receivableBaseItem.setLocation(x, y);
        x += receivableBaseItem.getWidth() + 10;
        priceBaseItem.setLocation(x, y);
        this.bPanel.setBounds((rect.width - bPanel.getWidth()) / 2, rect.height - 150, bPanel.getWidth(), bPanel.getHeight());

    }

    private void hideAllBaseButtons() {
        productBaseItem.setVisible(false);
        storageSearchBaseItem.setVisible(false);
        storageMinMaxBaseItem.setVisible(false);
        payableBaseItem.setVisible(false);
        receivableBaseItem.setVisible(false);
        employeeSaleBaseItem.setVisible(false);
        priceBaseItem.setVisible(false);

        subjectRemainBaseItem.setVisible(false);
        customerBaseItem.setVisible(false);
        storageBaseItem.setVisible(false);
        subjectBaseItem.setVisible(false);
    }

    private void hideAllPane() {
        this.basePanel.setVisible(false);
        salePanel.setVisible(false);
        storagePanel.setVisible(false);
        reportPanel.setVisible(false);
        this.clearingPanel.setVisible(false);
        bankCashPanel.setVisible(false);
        initPanel.setVisible(false);
        welcomePanel.setVisible(false);

//        this.basePanel.setVisible(false);
//        this.basePanel.setVisible(false);
//        this.basePanel.setVisible(false);
//        this.basePanel.setVisible(false);
//        this.basePanel.setVisible(false);
//        this.basePanel.setVisible(false);
//        this.basePanel.setVisible(false);
//        this.basePanel.setVisible(false);
        this.purchasePanel.setVisible(false);

    }

    public void mouseClicked(MouseEvent e) {
        Object source = e.getSource();
        //if (source == this.)
        if (source == this.purchaseButton) {
            this.showPurchasePane();
        } else if (source == this.saleButton) {
            this.showSalePane();
        } else if (source == this.storageButton) {
            this.showStoragePane();
        } else if (source == this.clearingButton) {
            this.showClearingPane();
        } else if (source == this.bankCashButton) {
            this.showBankCashPane();
        } else if (source == this.managerButton) {
            this.showManagerPane();
        } else if (source == this.reportButton) {
            this.showReportPane();
        } else if (source == this.baseButton) {
            this.showBasePane();
        } else if (source == this.initButton) {
            this.showInitPane();
        } else if (source == this.welcomePage) {
            this.showWelcomePane();
        } else if (source == productImageItem) {
            source = bProductManageItem;
        } else if (source == subjectImageItem) {
            source = bSubjectItem;
        } else if (source == customerImageItem) {
            source = bCustomerManageItem;
        } else if (source == employeeImageItem)//|| source ==employeeInfoButton)
        {
            source = bEmployeeManageItem;
        } else if (source == storageImageItem) {
            source = bWarehouseItem;
        } else if (source == wStorageInImageItem) {
            source = wStorageInItem;
        } else if (source == wStorageOutImageItem) {
            source = wStorageOutItem;
        } else if (source == wStorageOutflowImageItem) {
            source = wStorageOutflowItem;
        } else if (source == wStorageLossImageItem) {
            source = wStorageLossItem;
        } else if (source == wStorageMoveImageItem) {
            source = wStorageMoveItem;
        } else if (source == wStorageCheckImageItem) {
            source = wStorageCheckItem;
        } else if (source == wStorageChangeMoneyImageItem) {
            source = wStorageChangeMoneyItem;
        } else if (source == wStorageMaxMinImageItem) {
            //source = wStorageMaxMiImageItem;
            } else if (source == fStorageBeginManageImageItem) {
            source = fStorageBeginManageItem;
        } else if (source == bSubjectBeginManageImageItem) {
            source = bSubjectBeginManageItem;
        } else if (source == bReceivableBeginMangeImageItem) {
            source = bReceivableBeginMangeItem;
        } else if (source == bPaymentBeginManageImageItem) {
            source = bPaymentBeginManageItem;
        } else if (source == pOrderImageItem) {
            source = pOrderItem;
        } else if (source == pPurchaseImageItem) {
            source = pPurchaseItem;
        } else if (source == pPaymentImageItem) {
            source = pPaymentItem;
        } else if (source == mPayableClearingImageItem) {
            source = mPayableClearingItem;
        } else if (source == pOrderChangedImageItemList) {
            source = pOrderChangedImageItemList;
        } else if (source == pOrderChangedImageItem) {
            source = pOrderChangedItem;
        } else if (source == pOrderBackImageItem) {
            source = pOrderBack;
        } else if (source == sQuoteImageItem) {
            source = sQuoteItem;
        } else if (source == sOrderImageItem) {
            source = sOrderItem;
        } else if (source == sSaleListImageItem) {
            source = sSaleListItem;
        } else if (source == sGartheringImageItem) {
            source = sGartheringItem;
        } else if (source == sAjustPriceImageItem) {
            source = sAjustPriceItem;
        } else if (source == sOrderChangedImageItem) {
            source = sOrderChangedItem;
        } else if (source == sOrderChangedImageItemList) {
            source = sOrderChangedImageItemList;
        } else if (source == sOrderBackImageItem) {
            source = sOrderBackItem;
        } else if (source == sUserImageItem) {
            source = sUserItem;

        } else if (source == sCompanyInfoImageItem) {
            source = sCompanyInfoItem;
        } else if (source == sLogImageItem) {
            source = sLogItem;
        } else if (source == mPreReceivableImageItem) {
            source = mPreReceivableItem;
        } else if (source == mReceivableClearingImageItem) {
            source = mReceivableClearingItem;
        } else if (source == mPrePayableImageItem) {
            source = mPrePayableItem;
        } else if (source == mPayableClearingImageItem) {
            source = mPayableClearingItem;
        } else if (source == mBussinessExpenseImageItem) {
            source = mBussinessExpenseItem;
        } else if (source == mCommonExpenseImageItem) {
            source = mCommonExpenseItem;
        } else if (source == mOtherIncomeImageItem) {
            source = mOtherIncomeItem;
        } else if (source == mBankCashImageItem) {
            source = mBankCashItem;
        } else if (source == rPurchaseIndentImageItem) {
            source = rPurchaseIndentItem;
        } else if (source == rPurchaseIndentProStatImageItem) {
            source = rPurchaseIndentProStatItem;
        } else if (source == rPurchaseIndentProductImageItem) {
            source = rPurchaseIndentProductItem;
        } else if (source == rPurchaseIndentBalanceImageItem) {
            source = rPurchaseIndentBalanceItem;
        } else if (source == rPurchaseIndentProBalStatImageItem) {
            source = rPurchaseIndentProBalStatItem;
        } else if (source == rPurchaseIndentProBalDetailImageItem) {
            source = rPurchaseIndentProBalDetailItem;
        } else if (source == rPurchaseIndentSupplierStatImageItem) {
            source = rPurchaseIndentSupplierStatItem;
        } else if (source == rPurchaseIndentPersonStatImageItem) {
            source = rPurchaseIndentPersonStatItem;
        } else if (source == rProductPurchaseStatImageItem) {
            source = rProductPurchaseStatItem;
        } else if (source == rProductPurchaseDetailImageItem) {
            source = rProductPurchaseDetailItem;
        } else if (source == rSupplierPurchaseStatImageItem) {
            source = rSupplierPurchaseStatItem;
        } else if (source == rSupplierPurchaseDetailImageItem) {
            source = rSupplierPurchaseDetailItem;
        } else if (source == rEmployeePurchaseStatImageItem) {
            source = rEmployeePurchaseStatItem;
        } else if (source == rEmployeePurchaseDetailImageItem) {
            source = rEmployeePurchaseDetailItem;
        } else if (source == rProductPurchaseGatherImageItem) {
            source = rProductPurchaseGatherItem;
        } else if (source == rProductPurchasePriceWaveImageItem) {
            source = rProductPurchasePriceWaveItem;
        } else if (source == rSaleIndentImageItem) {
            source = rSaleIndentItem;
        } else if (source == rSaleIndentProStatImageItem) {
            source = rSaleIndentProStatItem;
        } else if (source == rSaleIndentProductImageItem) {
            source = rSaleIndentProductItem;
        } else if (source == rSaleIndentBalanceImageItem) {
            source = rSaleIndentBalanceItem;
        } else if (source == rSaleIndentProBalStatImageItem) {
            source = rSaleIndentProBalStatItem;
        } else if (source == rSaleIndentProBalDetailImageItem) {
            source = rSaleIndentProBalDetailItem;
        } else if (source == rSaleIndentCustomerStatImageItem) {
            source = rSaleIndentCustomerStatItem;
        } else if (source == rSaleIndentPersonStatImageItem) {
            source = rSaleIndentPersonStatItem;
        } //            else if(source == rCustomerMonthSaleCompareImageItem)
        //            {
        //                source = rCustomerMonthSaleCompareItem;
        //            }
        //            else if(source == rProductMonthSaleCompareImageItem)
        //            {
        //                source = rProductMonthSaleCompareItem;
        //            }
        //            else if(source == rCustomerSaleOrderImageItem)
        //            {
        //                source = rCustomerSaleOrderItem;
        //            }
        //            else if(source == rProductSaleOrderImageItem)
        //            {
        //                source = rProductSaleOrderItem;
        //            }
        //            else if(source == rEmployeeSaleOrderImageItem)
        //            {
        //                source = rEmployeeSaleOrderItem;
        //            }
        else if (source == rProductSaleStatImageItem) {
            source = rProductSaleStatItem;
        } else if (source == rProductSaleDetailImageItem) {
            source = rProductSaleDetailItem;
        } else if (source == rSupplierSaleStatImageItem) {
            source = rCustomerSaleStatItem;
        } else if (source == rSupplierSaleDetailImageItem) {
            source = rCustomerSaleDetailItem;
        } else if (source == rEmployeeSaleStatImageItem) {
            source = rEmployeeSaleStatItem;
        } else if (source == rEmployeeSaleDetailImageItem) {
            source = rEmployeeSaleDetailItem;
        } //            else if(source == rProductSaleGatherImageItem)
        //            {
        //                source = rProductSaleGatherItem;
        //            }
        //            else if(source == rProductPriceImageItem)
        //            {
        //                source = rProductPriceItem;
        //            }
        //            else if(source == rProductSalePriceWaveImageItem)
        //            {
        //                source = rProductSalePriceWaveItem;
        //            }
        else if (source == rSubjectBalanceImageItem) {
            source = rSubjectBalanceItem;
        } else if (source == rCashBankMonthReportImageItem) {
            source = rCashBankMonthReportItem;
        } else if (source == rCashBankDetailImageItem) {
            source = rCashBankDetailItem;
        } else if (source == rDailyFeeReportImageItem) {
            source = rDailyFeeReportItem;
        } else if (source == rDailyFeeDetailImageItem) {
            source = rDailyFeeDetailItem;
        } else if (source == rOtherIncomeMonthReportImageItem) {
            source = rOtherIncomeMonthReportItem;
        } else if (source == rOtherIncomeDetailImageItem) {
            source = rOtherIncomeDetailItem;
        } else if (source == rSupplierPayBalanceImageItem) {
            source = rSupplierPayBalanceItem;
        } else if (source == rSupplierUnbalanceDetailImageItem) {
            source = rSupplierUnbalanceDetailItem;
        } else if (source == rCustomerReceiveBalanceImageItem) {
            source = rCustomerReceiveBalanceItem;
        } else if (source == rCustomerUnbalanceDetailImageItem) {
            source = rCustomerUnbalanceDetailItem;
        } else if (source == rSupplierQueryImageItem) {
            source = rSupplierQueryItem;
        } else if (source == rCustomerQueryImageItem) {
            source = rCustomerQueryItem;
        }
        acted(source);

    }

    public void actionPerformed(ActionEvent e) {
        Object source = e.getSource();
        acted(source);
    }

    private void noPermission() {
        JOptionPane.showMessageDialog(rootPane, "您无此权限,请与系统管理员联系!\n");
    }

    private void acted(Object source) {
        Permission permission = (Permission) service.getPermission(company, user);
        if (permission != null) {
            if (source == bProductManageItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getBaseProduct())) {
                    this.noPermission();
                } else {
                    showProductManageWindow();
                }
            } else if (source == bSubjectItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getCwkjkm())) {
                    this.noPermission();
                } else {
                    showSubjectManageWindow();
                }
            } else if (source == bCustomerManageItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getBaseCustomer())) {
                    this.noPermission();
                } else {
                    showCustomerManageWindow();
                }
            } else if (source == refreshItem) {
                refreshDataBase();
            } else if (source == exitItem) {
                //doClose(e);
                close();
            } else if (source == bEmployeeManageItem)//|| source ==employeeInfoButton)
            {
                if (!PermissionUtilities.hasModulePermission(permission.getBaseEmployee())) {
                    this.noPermission();
                } else {
                    showEmployeeWindow();
                }
            } else if (source == bWarehouseItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getBaseStorage())) {
                    this.noPermission();
                } else {
                    showStorageManageWindow();
                }
            } else if (source == bDatabaseItem) {
                showDatabaseTool();
            } else if (source == wStorageInItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getStorageSprk())) {
                    this.noPermission();
                } else {

                    addStorageInForm();
                }
            } else if (source == wStorageInImageItemList) {
                if (!PermissionUtilities.hasModulePermission(permission.getStorageSprk())) {
                    this.noPermission();
                } else {
                    //showStorageInWindow();
                    showStorageInWindow();
                }
            } else if (source == wStorageOutItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getStorageCpck())) {
                    this.noPermission();
                } else {

                    addStorageOutForm();
                }
            } else if (source == wStorageOutImageItemList) {
                if (!PermissionUtilities.hasModulePermission(permission.getStorageCpck())) {
                    this.noPermission();
                } else {
                    showStorageOutWindow();
                }
            } else if (source == wStorageOutflowItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getStorageKcby())) {
                    this.noPermission();
                } else {

                    addOutflowForm();
                }
            } else if (source == wStorageOutflowImageItemList) {
                if (!PermissionUtilities.hasModulePermission(permission.getStorageKcby())) {
                    this.noPermission();
                } else {
                    showStorageOutflowWindow();
                }
            } else if (source == wStorageLossItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getStorageKcbs())) {
                    this.noPermission();
                } else {

                    addStorageLossForm();
                }
            } else if (source == wStorageLossImageItemList) {
                if (!PermissionUtilities.hasModulePermission(permission.getStorageKcbs())) {
                    this.noPermission();
                } else {
                    showStorageLossWindow();
                }
            } else if (source == wStorageMoveItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getStorageYkgl())) {
                    this.noPermission();
                } else {

                    addStorageMoveForm();
                }
            } else if (source == wStorageMoveImageItemList) {
                if (!PermissionUtilities.hasModulePermission(permission.getStorageYkgl())) {
                    this.noPermission();
                } else {
                    showStorageMoveWindow();
                }
            } else if (source == wStorageCheckItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getStoragePdgl())) {
                    this.noPermission();
                } else {

                    addStorageCheckForm();
                }
            } else if (source == wStorageCheckImageItemList) {
                if (!PermissionUtilities.hasModulePermission(permission.getStoragePdgl())) {
                    this.noPermission();
                } else {
                    showStorageCheckWindow();
                }
            } else if (source == wStorageChangeMoneyItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getStorageKcbj())) {
                    this.noPermission();
                } else {
                    addStorageChangeMoneyForm();
                }
            } else if (source == wStorageChangeMoneyImageItemList) {
                if (!PermissionUtilities.hasModulePermission(permission.getStorageKcbj())) {
                    this.noPermission();
                } else {
                    showStorageChangeMoneyWindow();
                }
            } else if (source == wStorageMaxMinImageItemList) {
                if (!PermissionUtilities.hasModulePermission(permission.getStorageSxxz())) {
                    this.noPermission();
                } else {
                    showStorageMaxMinWindow();

                }
            } else if (source == wStorageMaxMinItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getStorageSxxz())) {
                    this.noPermission();
                } else {
                    addStorageMaxMinForm();

                }
            } else if (source == sQuoteImageItemList) {

                if (!PermissionUtilities.hasModulePermission(permission.getXsbj())) {
                    this.noPermission();
                } else {
                    showSaleQuoteWindow();
                }
            } else if (source == sQuoteItem) {

                if (!PermissionUtilities.hasModulePermission(permission.getXsbj())) {
                    this.noPermission();
                } else {
                    addSaleQuoteForm();
                }
            } else if (source == sOrderImageItemList) {

                if (!PermissionUtilities.hasModulePermission(permission.getXsdd())) {
                    this.noPermission();
                } else {
                    showSaleOrderWindow();
                }
            } else if (source == sOrderItem) {

                if (!PermissionUtilities.hasModulePermission(permission.getXsdd())) {
                    this.noPermission();
                } else {
                    addSaleOrderForm();
                }
            } else if (source == sSaleListImageItemList) {
                if (!PermissionUtilities.hasModulePermission(permission.getXsd())) {
                    this.noPermission();
                } else {
                    showSaleDetailWindow();
                }
            } else if (source == sSaleListItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getXsd())) {
                    this.noPermission();
                } else {
                    addSaleDetailForm();
                }
            } else if (source == sGartheringItem) {

                if (!PermissionUtilities.hasModulePermission(permission.getCwskjs())) {
                    this.noPermission();
                } else {
                    addReceivableClearingForm();
                }
            } else if (source == sGartheringImageItemList) {

                if (!PermissionUtilities.hasModulePermission(permission.getCwskjs())) {
                    this.noPermission();
                } else {
                    showReceivableClearingManageWindow();
                }
            } else if (source == sAjustPriceItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getXssptj())) {
                    this.noPermission();
                } else {
                    addSaleChangeMoneyForm();
                }
            } else if (source == sOrderChangedItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getXssptj())) {
                    this.noPermission();
                } else {
                    addSaleOrderChangedForm();
                }
            } else if (source == sOrderChangedImageItemList) {
                if (!PermissionUtilities.hasModulePermission(permission.getXssptj())) {
                    this.noPermission();
                } else {
                    showSaleOrderChangeWindow();

                }
            } else if (source == sAjustPriceImageItemList) {
                if (!PermissionUtilities.hasModulePermission(permission.getXssptj())) {
                    this.noPermission();
                } else {
                    showSaleChangeMoneyWindow();
                }
            } else if (source == sOrderBackItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getXsth())) {
                    this.noPermission();
                } else {
                    addSaleOrderBackForm();
                }
            } else if (source == sOrderBackImageItemList) {
                if (!PermissionUtilities.hasModulePermission(permission.getXsth())) {
                    this.noPermission();
                } else {
                    showSaleOrderBackWindow();
                }
            } else if (source == pOrderImageItemList) {
                if (!PermissionUtilities.hasModulePermission(permission.getCgdd())) {
                    this.noPermission();
                } else {
                    showPurchaseOrderWindow();
                }
            } else if (source == pOrderItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getCgdd())) {
                    this.noPermission();
                } else {
                    addPurchaseOrderForm();
                }
            } else if (source == pPurchaseItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getCgd())) {
                    this.noPermission();
                } else {
                    addPurchaseDetailForm();
                }
            } else if (source == pPurchaseImageItemList) {
                if (!PermissionUtilities.hasModulePermission(permission.getCgd())) {
                    this.noPermission();
                } else {

                    showPurchaseDetailWindow();
                }
            } else if (source == pPaymentItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getCwfkjs())) {
                    this.noPermission();
                } else {
                    addPurchasePaymentForm();
                }
            } else if (source == pPaymentImageItemList) {
                if (!PermissionUtilities.hasModulePermission(permission.getCwfkjs())) {
                    this.noPermission();
                } else {
                    showPurchasePaymentWindow();
                }
            } else if (source == pOrderChangedItem) {
                addOrderChangedForm();
            } else if (source == pOrderChangedImageItemList) {
                showPurchaseChangeOrderWindow();
            } else if (source == pOrderBack) {
                if (!PermissionUtilities.hasModulePermission(permission.getCgth())) {
                    this.noPermission();
                } else {
                    addPurchaseOrderBackForm();
                }
            } else if (source == pOrderBackImageItemList) {
                if (!PermissionUtilities.hasModulePermission(permission.getCgth())) {

                    this.noPermission();
                } else {
                    showPurchaseOrderBackWindow();
                }
            } else if (source == mPreReceivableImageItemList) {
                if (!PermissionUtilities.hasModulePermission(permission.getCwxsyf())) {
                    this.noPermission();
                } else {
                    showPrereceivableManageWindow();
                }
            } else if (source == mPreReceivableItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getCwxsyf())) {
                    this.noPermission();
                } else {
                    addPrereceivableForm();
                }
            } else if (source == mReceivableClearingItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getCwskjs())) {
                    this.noPermission();
                } else {
                    addReceivableClearingForm();
                }
            } else if (source == mReceivableClearingImageItemList) {
                if (!PermissionUtilities.hasModulePermission(permission.getCwskjs())) {
                    this.noPermission();
                } else {
                    showReceivableClearingManageWindow();
                }
            } else if (source == mPrePayableItem) {

                if (!PermissionUtilities.hasModulePermission(permission.getCwcgyf())) {
                    this.noPermission();
                } else {
                    addPrepayableForm();
                }
            } else if (source == mPrePayableImageItemList) {

                if (!PermissionUtilities.hasModulePermission(permission.getCwcgyf())) {
                    this.noPermission();
                } else {
                    showPrepayableManageWindow();
                }
            } else if (source == mPayableClearingImageItemList) {

                if (!PermissionUtilities.hasModulePermission(permission.getCwfkjs())) {
                    this.noPermission();
                } else {
                    showPayableClearingManageWindow();
                }
            } else if (source == mPayableClearingItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getCwfkjs())) {
                    this.noPermission();
                } else {
                    addPayableClearingForm();
                }
            } else if (source == mBussinessExpenseImageItemList) {
                if (!PermissionUtilities.hasModulePermission(permission.getCwjyfy())) {
                    this.noPermission();
                } else {
                    showBussinessExpenseManageWindow();
                }
            } else if (source == mBussinessExpenseItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getCwjyfy())) {
                    this.noPermission();
                } else {
                    addBussinessExpenseForm();
                }
            } else if (source == mCommonExpenseImageItemList) {
                if (!PermissionUtilities.hasModulePermission(permission.getCwybfy())) {
                    this.noPermission();
                } else {
                    showCommonExpenseManageWindow();
                }
            } else if (source == mCommonExpenseItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getCwybfy())) {
                    this.noPermission();
                } else {
                    addCommonExpenseForm();
                }
            } else if (source == mOtherIncomeImageItemList) {
                if (!PermissionUtilities.hasModulePermission(permission.getCwqtsr())) {
                    this.noPermission();
                } else {
                    showOtherIncomeManageWindow();
                }
            } else if (source == mOtherIncomeItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getCwqtsr())) {
                    this.noPermission();
                } else {
                    addOtherIncomeForm();
                }
            } else if (source == mBankCashImageItemList) {
                if (!PermissionUtilities.hasModulePermission(permission.getCwxjyh())) {
                    this.noPermission();
                } else {
                    showBankCashManageWindow();
                }
            } else if (source == mBankCashItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getCwxjyh())) {
                    this.noPermission();
                } else {
                    addBankCashForm();
                }
            } //            else if (source == storageAlertButton) {
            //                showStorageAlertQueryDialog();
            //            }
            else if (source == fStorageBeginManageImageItemList) {

                if (!PermissionUtilities.hasModulePermission(permission.getInitKcqc())) {
                    this.noPermission();
                } else {
                    showBeginStorageManageWindow();
                }
            } else if (source == fStorageBeginManageItem) {

                if (!PermissionUtilities.hasModulePermission(permission.getInitKcqc())) {
                    this.noPermission();
                } else {
                    addBeginStorageForm();
                }
            } else if (source == bSubjectBeginManageImageItemList) {

                if (!PermissionUtilities.hasModulePermission(permission.getCwkmyeqc())) {
                    this.noPermission();
                } else {
                    showBeginSubjectManageWindow();
                }
            } else if (source == bSubjectBeginManageItem) {

                if (!PermissionUtilities.hasModulePermission(permission.getCwkmyeqc())) {
                    this.noPermission();
                } else {
                    addBeginSubjectForm();
                }
            } else if (source == bReceivableBeginMangeImageItemList) {
                if (!PermissionUtilities.hasModulePermission(permission.getCwysqc())) {
                    this.noPermission();
                } else {
                    showBeginReceiveableManageWindow();
                }
            } else if (source == bReceivableBeginMangeItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getCwysqc())) {
                    this.noPermission();
                } else {
                    addBeginReceiveableForm();
                }
            } else if (source == bPaymentBeginManageImageItemList) {
                if (!PermissionUtilities.hasModulePermission(permission.getCwyfqc())) {
                    this.noPermission();
                } else {
                    showBeginPaymentManageWindow();
                }
            } else if (source == bPaymentBeginManageItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getCwyfqc())) {
                    this.noPermission();
                } else {
                    addBeginPaymentForm();
                }
            } else if (source == this.refreshBaseInfo) {
                refreshDataBase();
            } else if (source == hAboutItem) {
                showAboutDialog();
            } else if (source == sUserItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getSystemYhxx())) {
                    this.noPermission();
                } else {
                    showUserManageWindow();
                }
            } else if (source == sChangePasswordItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getSystemXgmm())) {
                    this.noPermission();
                } else {
                    showChangePasswordDialog();
                }
            } else if (source == sCompanyInfoItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getSystemGsxx())) {
                    this.noPermission();
                } else {
                    showCompanyInfoDialog();
                }
            } /*else if(source == sRoleItem)
            {
            showRoleManageDialog();
            }*/ else if (source == sLogItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getSystemXtrz())) {
                    this.noPermission();
                } else {
                    showCSystemLogWindow();
                }
            } else if (source == sOptionItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getSystemxlkgl())) {
                    this.noPermission();
                } else {
                    showSystemOptionDialog();
                }
            } else if (source == sNumberManageItem || source == this.sNumberImageItem)//liufei
            {
                if (!PermissionUtilities.hasModulePermission(permission.getSystemxlkgl()))//need changed
                {
                    this.noPermission();
                } else {
                    showNumberManageDialog();
                }
            } else if (source == sListProUnitItem)//liufei
            {
                if (!PermissionUtilities.hasModulePermission(permission.getSystemxlkgl())) {
                    this.noPermission();
                } else {
                    showCProUnitListDialog();
                }
            } else if (source == sListProShelfItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getSystemxlkgl())) {
                    this.noPermission();
                } else {
                    showCProShelfListDialog();
                }
            } else if (source == sListProTaxrateItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getSystemxlkgl())) {
                    this.noPermission();
                } else {
                    showCProTaxrateListDialog();
                }
            } else if (source == sListCusTypeItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getSystemxlkgl())) {
                    this.noPermission();
                } else {
                    showCCusTypeListDialog();
                }
            } else if (source == sListCusPriceItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getSystemxlkgl())) {
                    this.noPermission();
                } else {
                    showCCusPriceListDialog();
                }
            } else if (source == sListCusInvoiceItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getSystemxlkgl())) {
                    this.noPermission();
                } else {
                    showCCusInvoiceListDialog();
                }
            } else if (source == sListEmpDutyItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getSystemxlkgl())) {
                    this.noPermission();
                } else {
                    showCEmpDutyListDialog();
                }
            } else if (source == sListEmpDegreeItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getSystemxlkgl())) {
                    this.noPermission();
                } else {
                    showCEmpDegreeListDialog();
                }
            } else if (source == sListEmpLevelItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getSystemxlkgl())) {
                    this.noPermission();
                } else {
                    showCEmpLevelListDialog();
                }
            } else if (source == sListEmpHealthItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getSystemxlkgl())) {
                    this.noPermission();
                } else {
                    showCEmpHealthListDialog();
                }
            } else if (source == sListStoTypeItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getSystemxlkgl())) {
                    this.noPermission();
                } else {
                    showCStoTypeListDialog();
                }
            } else if (source == rStorageBalanceItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportKcspye())) {
                    this.noPermission();
                } else {
                    showStorageQueryWindow();
                }
            } else if (source == rStorageInDetailedItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportKcrkmx())) {
                    this.noPermission();
                } else {
                    showStorageInListQueryWindow();
                }
            } else if (source == rStorageOutDetailedItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportKcckmx())) {
                    this.noPermission();
                } else {
                    showStorageOutListQueryWindow();
                }
            } else if (source == rStorageInItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportKccprk())) {
                    this.noPermission();
                } else {
                    showStorageInReportWindow();
                }
            } else if (source == rStorageOutItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportKccpck())) {
                    this.noPermission();
                } else {
                    showStorageOutReportWindow();
                }
            } else if (source == rStorageMaxMinItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportKccpsxx())) {
                    this.noPermission();
                } else {
                    showStorageMinMaxQueryWindow();
                }
            } else if (source == rStorageAlertItem) {
                showStorageAlertQueryDialog();
            } else if (source == rStorageMoveReporItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportKcyk())) {
                    this.noPermission();
                } else {
                    showStorageMoveReportWindow();
                }

            } else if (source == rStorageCheckReporItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportKcpd())) {
                    this.noPermission();
                } else {
                    showStorageCheckReportWindow();
                }

            } else if (source == rStorageOutflowReporItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportKcby())) {
                    this.noPermission();
                } else {
                    showStorageOutflowReportWindow();
                }

            } else if (source == rStorageLossReporItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportKcbs())) {
                    this.noPermission();
                } else {
                    showStorageLossReportWindow();
                }

            } else if (source == rStorageChangeMoneyItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportKcbjmx())) {
                    this.noPermission();
                } else {
                    showStorageChangeMoneyReportWindow();
                }

            } else if (source == rStorageMoveItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportKcykmx())) {
                    this.noPermission();
                } else {
                    showStorageMoveQueryWindow();
                }

            } else if (source == rStorageCheckItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportKcpdmx())) {
                    this.noPermission();
                } else {
                    showStorageCheckQueryWindow();
                }

            } else if (source == rStorageOutflowItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportKcbymx())) {
                    this.noPermission();
                } else {
                    showStorageOutflowQueryWindow();
                }

            } else if (source == rStorageLossItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportKcbsmx())) {
                    this.noPermission();
                } else {
                    showStorageLossQueryWindow();
                }

            } else if (source == rPurchaseIndentItem) {
                //1111111111111111111111111111111111111111111111111111111111111111111111
                if (!PermissionUtilities.hasModulePermission(permission.getReportCdcx())) {
                    this.noPermission();
                } else {
                    showPurchaseIndentQueryWindow();
                }
            } else if (source == rPurchaseIndentProStatItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportCdsptj())) {
                    this.noPermission();
                } else {
                    showPurchaseIndentProductStatWindow();
                }
            } else if (source == rPurchaseIndentProductItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportCdspcx())) {
                    this.noPermission();
                } else {
                    showPurchaseIndentProductQueryWindow();
                }
            } else if (source == rPurchaseIndentBalanceItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportCdspyecx())) {
                    this.noPermission();
                } else {
                    showPurchaseIndentBalanceQueryWindow();
                }
            } else if (source == rPurchaseIndentProBalStatItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportCdspyetj())) {
                    this.noPermission();
                } else {
                    showPurchaseIndentProBalStatWindow();
                }
            } else if (source == rPurchaseIndentProBalDetailItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportCdyecx())) {
                    this.noPermission();
                } else {
                    showPurchaseIndentProBalDetailWindow();
                }
            } else if (source == rPurchaseIndentSupplierStatItem) {
//                sssss
                if (!PermissionUtilities.hasModulePermission(permission.getReportCdkstj())) {
                    this.noPermission();
                } else {
                    showPurchaseIndentSupplierStatWindow();
                }
            } else if (source == rPurchaseIndentPersonStatItem) {
                //1111
                if (!PermissionUtilities.hasModulePermission(permission.getReportCdspyetj())) {
                    this.noPermission();
                } else {
                    showPurchaseIndentPersonStatWindow();
                }
            } else if (source == rProductPurchaseStatItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportCgtj())) {
                    this.noPermission();
                } else {
                    showProductPurchaseStatReportWindow();
                }
            } else if (source == rProductPurchaseDetailItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportCgmx())) {
                    this.noPermission();
                } else {
                    showProductPurchaseDetailQueryWindow();
                }
            } else if (source == rSupplierPurchaseStatItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportCgkstj())) {
                    this.noPermission();
                } else {
                    showSupplierPurchaseStatReportWindow();
                }
            } else if (source == rSupplierPurchaseDetailItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportCgksmx())) {
                    this.noPermission();
                } else {
                    showSupplierPurchaseDetailQueryWindow();
                }
            } else if (source == rEmployeePurchaseStatItem) {

                if (!PermissionUtilities.hasModulePermission(permission.getReportCgywytj())) {
                    this.noPermission();
                } else {
                    showEmployeePurchaseStatReportWindow();
                }
            } else if (source == rEmployeePurchaseDetailItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportCgywymx())) {
                    this.noPermission();
                } else {
                    showEmployeePurchaseDetailQueryWindow();
                }
            } else if (source == rProductPurchaseGatherItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportCdywytj())) {
                    this.noPermission();
                } else {
                    showProductPurchaseGatherReportWindow();
                }
            } else if (source == rProductPurchasePriceWaveItem) {
                //tenf
                if (!PermissionUtilities.hasModulePermission(permission.getSystemGsxx())) {
                    this.noPermission();
                } else {
                    showProductPurchasePriceWaveReportWindow();
                }
            } else if (source == rSaleIndentItem) {

                if (!PermissionUtilities.hasModulePermission(permission.getReportXdcx())) {
                    this.noPermission();
                } else {
                    showSaleIndentQueryWindow();
                }
            } else if (source == rSaleIndentProStatItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportXdsptj())) {
                    this.noPermission();
                } else {
                    showSaleIndentProductStatWindow();
                }
            } else if (source == rSaleIndentProductItem) {

                if (!PermissionUtilities.hasModulePermission(permission.getReportXdspcx())) {
                    this.noPermission();
                } else {
                    showSaleIndentProductQueryWindow();
                }
            } else if (source == rSaleIndentBalanceItem) {
                //123
                if (!PermissionUtilities.hasModulePermission(permission.getSystemGsxx())) {
                    this.noPermission();
                } else {
                    showSaleIndentBalanceQueryWindow();
                }
            } else if (source == rSaleIndentProBalStatItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getSystemGsxx())) {
                    this.noPermission();
                } else {
                    showSaleIndentProBalStatWindow();
                }
            } else if (source == rSaleIndentProBalDetailItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getSystemGsxx())) {
                    this.noPermission();
                } else {
                    showSaleIndentProBalDetailWindow();
                }
            } else if (source == rSaleIndentCustomerStatItem) {

                if (!PermissionUtilities.hasModulePermission(permission.getReportCdkstj())) {
                    this.noPermission();
                } else {
                    showSaleIndentCustomerStatWindow();
                }
            } else if (source == rSaleIndentPersonStatItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportXdywytj())) {
                    this.noPermission();
                } else {
                    showSaleIndentPersonStatWindow();
                }
            } //            else if(source == rCustomerMonthSaleCompareItem)
            //            {
            //                showCustomerMonthSaleCompareWindow();
            //            }
            //            else if(source == rProductMonthSaleCompareItem)
            //            {
            //                showProductMonthSaleCompareWindow();
            //            }
            //            else if(source == rCustomerSaleOrderItem)
            //            {
            //                showCustomerSaleOrderWindow();
            //            }
            //            else if(source == rProductSaleOrderItem)
            //            {
            //                showProductSaleOrderWindow();
            //            }
            //            else if(source == rEmployeeSaleOrderItem)
            //            {
            //                showEmployeeSaleOrderWindow();
            //            }
            else if (source == rProductSaleStatItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportXsmx())) {
                    this.noPermission();
                } else {
                    showProductSaleStatWindow();
                }
            } else if (source == rProductSaleDetailItem) {

                if (!PermissionUtilities.hasModulePermission(permission.getReportXstj())) {
                    this.noPermission();
                } else {
                    showProductSaleDetailWindow();
                }
            } else if (source == rCustomerSaleStatItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportXskstj())) {
                    this.noPermission();
                } else {
                    showCustomerSaleStatWindow();
                }
            } else if (source == rCustomerSaleDetailItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportXsksmx())) {
                    this.noPermission();
                } else {
                    showCustomerSaleDetailWindow();
                }
            } else if (source == rEmployeeSaleStatItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportXsywytj())) {
                    this.noPermission();
                } else {
                    showEmployeeSaleStatWindow();
                }
            } else if (source == rEmployeeSaleDetailItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportXywymx())) {
                    this.noPermission();
                } else {
                    showEmployeeSaleDetailWindow();
                }
            } //            else if(source == rProductSaleGatherItem)
            //            {
            //                showProductSaleGatherWindow();
            //            }
            //            else if(source == rProductPriceItem)
            //            {
            //                showProductPriceQueryWindow();
            //            }
            //            else if(source == rProductSalePriceWaveItem)
            //            {
            //                showProductSalePriceWaveWindow();
            //            }
            else if (source == rSubjectBalanceItem) {

                if (!PermissionUtilities.hasModulePermission(permission.getReportCwkmye())) {
                    this.noPermission();
                } else {
                    showSubjectQueryWindow();
                }
            } else if (source == rCashBankMonthReportItem) {

                if (!PermissionUtilities.hasModulePermission(permission.getSystemGsxx())) {
                    this.noPermission();
                } else {
                    showCashBankMonthReportWindow();
                }
            } else if (source == rCashBankDetailItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getSystemGsxx())) {
                    this.noPermission();
                } else {
                    showCashBankDetailQueryWindow();
                }
            } else if (source == rDailyFeeReportItem) {

                if (!PermissionUtilities.hasModulePermission(permission.getReportCwrcfybb())) {
                    this.noPermission();
                } else {
                    showDailyFeeReportWindow();
                }
            } else if (source == rDailyFeeDetailItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportCwrcfymx())) {
                    this.noPermission();
                } else {
                    showDailyFeeDetailQueryWindow();
                }
            } else if (source == rOtherIncomeMonthReportItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportCwqtsrybb())) {
                    this.noPermission();
                } else {
                    showOtherIncomeMonthReportWindow();
                }
            } else if (source == rOtherIncomeDetailItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportCwqtsrmx())) {
                    this.noPermission();
                } else {
                    showOtherIncomeDetailQueryWindow();
                }
            } else if (source == rSupplierPayBalanceItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportJsgksysye())) {
                    this.noPermission();
                } else {
                    showSupplierPayBalanceQueryWindow();
                }
            } else if (source == rSupplierUnbalanceDetailItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportJsgkswfmx())) {
                    this.noPermission();
                } else {
                    showSupplierUnbalanceDetailQueryWindow();
                }
            } else if (source == rCustomerReceiveBalanceItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportJsgxsyfye())) {
                    this.noPermission();
                } else {
                    showCustomerReceiveBalanceQueryWindow();
                }
            } else if (source == rCustomerUnbalanceDetailItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getReportJsgxswjmx())) {
                    this.noPermission();
                } else {
                    showCustomerUnbalanceDetailQueryWindow();
                }
            } else if (source == rSupplierQueryItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getSystemGsxx())) {
                    this.noPermission();
                } else {
                    showSupplierQueryWindow();
                }
            } else if (source == rCustomerQueryItem) {
                if (!PermissionUtilities.hasModulePermission(permission.getSystemGsxx())) {
                    this.noPermission();
                } else {
                    showCustomerQueryWindow();
                }
            } else if (source == customerBaseItem) {
                showCustomerManageWindow();

            } else if (source == productBaseItem) {
                showProductManageWindow();
            } else if (source == storageSearchBaseItem) {
                showStorageQueryWindow();
            } else if (source == payableBaseItem) {
                showSupplierUnbalanceDetailQueryWindow();
            }//"/resources/png/items/24/search.png")), "供应商应付未结");
            else if (source == receivableBaseItem) {
                showCustomerUnbalanceDetailQueryWindow();
            }//"/resources/png/items/24/search.png")), "客户应收未结");
            else if (source == employeeSaleBaseItem) {
            }//"/resources/png/items/24/employee.png")), "业务员业绩");
            else if (source == priceBaseItem) {
                showProductPriceQueryWindow();
            }//"/resources/png/items/24/money.png")), "价格信息");
            else if (source == subjectRemainBaseItem) {
                showSubjectQueryWindow();
            }//"/resources/png/items/24/money.png")), "科目余额");
            else if (source == storageBaseItem) {
                showStorageManageWindow();
            }//"/resources/png/items/24/storage.png")), "仓库资料");
            else if (source == subjectBaseItem) {
                showSubjectManageWindow();
            }//"/resources/png/items/24/subject.png")), "会计科目");

                 else if (source == salesReportImageItem){
                    showSaleReportWindow();
                 }
        else if (source == storageReportImageItem){}
        else if (source == purchaseReportImageItem){}
        else if (source == bankCashReportImageItem){}
        else if (source == clearingImageItem){}
        else if (source == initReportImageItem){}
            else {
                //notSupported();
            }
        }
    }

    public void notSupported() {
        JOptionPane.showMessageDialog(this, "暂时未实现!");
    }

    public void mouseEntered(MouseEvent e) {
    }

    public void mouseExited(MouseEvent e) {
    }

    public void mousePressed(MouseEvent e) {
    }

    public void mouseReleased(MouseEvent e) {
    }

    @Override
    public void setVisible(boolean b) {

        Rectangle rect = this.clientPanel.getBounds();
        this.helpPane.setBounds((rect.width - helpPane.getWidth()) / 2, rect.height - this.helpPane.getHeight(), helpPane.getWidth(), helpPane.getHeight());
        super.setVisible(b);
        this.showWelcomePane();
    }
    private CNaviButton purchaseButton;
    private CNaviButton saleButton;
    private CNaviButton storageButton;
    private CNaviButton clearingButton;
    private CNaviButton bankCashButton;
    private CNaviButton reportButton;
    private CNaviButton managerButton;
    private CNaviButton baseButton;
    private CNaviButton initButton;
    private CImageItem productImageItem;
    private CImageItem customerImageItem;
    private CImageItem employeeImageItem;
    private CImageItem storageImageItem;
    private CImageItem subjectImageItem;
    private CImageItem salesReportImageItem;
    private CImageItem storageReportImageItem;
    private CImageItem purchaseReportImageItem;
    private CImageItem bankCashReportImageItem;
    private CImageItem clearingImageItem;
    private CImageItem initReportImageItem;
    private CImageItem mBussinessExpenseImageItem;// = new CMenuImageItem("缁ヨ垂");
    private CLittleImageItem mBussinessExpenseImageItemList;
    private CImageItem mCommonExpenseImageItem;// = new CMenuItem("涓?璐圭");
    private CLittleImageItem mCommonExpenseImageItemList;
    private CImageItem mOtherIncomeImageItem;//= new CMenuItem("跺跺");
    private CLittleImageItem mOtherIncomeImageItemList;
    private CImageItem mBankCashImageItem;// = new CMenuItem("惰甯");
    private CLittleImageItem mBankCashImageItemList;
    private CImageItem fStorageBeginManageImageItem;
    private CLittleImageItem fStorageBeginManageImageItemList;
    private CImageItem bSubjectBeginManageImageItem;// = new CImageItem("绉浣棰绠＄");
    private CLittleImageItem bSubjectBeginManageImageItemList;
    private CImageItem bReceivableBeginMangeImageItem;// = new CImageItem("搴舵绠＄");
    private CLittleImageItem bReceivableBeginMangeImageItemList;
    private CImageItem bPaymentBeginManageImageItem;// = new CImageItem("搴浠绠＄");
    private CLittleImageItem bPaymentBeginManageImageItemList;
    //purchase
    private CImageItem pOrderImageItem;// = new CMenuItem("璐璁㈠");
    private CLittleImageItem pOrderImageItemList;
    private CImageItem pPurchaseImageItem;// = new CMenuItem("璐?);
    private CLittleImageItem pPurchaseImageItemList;
    private CImageItem pPaymentImageItem;// = new CMenuItem("浠娆剧绠");
    private CLittleImageItem pPaymentImageItemList;
    private CImageItem pOrderChangedImageItem;// = new CMenuItem("璁㈠");
    private CLittleImageItem pOrderChangedImageItemList;
    private CImageItem pOrderBackImageItem;// = new CMenuItem("璐?揣");
    private CLittleImageItem pOrderBackImageItemList;

    //sale
    private CImageItem sQuoteImageItem;// = new CMenuItem("ヤ环");
    private CLittleImageItem sQuoteImageItemList;
    private CImageItem sOrderImageItem;// = new CMenuItem("?璁㈠");
    private CLittleImageItem sOrderImageItemList;
    private CImageItem sSaleListImageItem;// = new CMenuItem("?娓");
    private CLittleImageItem sSaleListImageItemList;
    private CImageItem sGartheringImageItem;// = new CMenuItem("舵剧绠");
    private CLittleImageItem sGartheringImageItemList;
    private CImageItem sAjustPriceImageItem;// = new CMenuItem("璋浠");
    private CLittleImageItem sAjustPriceImageItemList;
    private CImageItem sOrderChangedImageItem;// = new CMenuItem("璁㈠");
    private CLittleImageItem sOrderChangedImageItemList;
    private CImageItem sOrderBackImageItem;// = new CMenuItem("??揣");
    private CLittleImageItem sOrderBackImageItemList;
    //
    private CImageItem mPreReceivableImageItem;// = new CMenuItem("?棰剁＄");
    private CLittleImageItem mPreReceivableImageItemList;
    private CImageItem mReceivableClearingImageItem;// = new CMenuItem("舵剧绠绠＄");
    private CLittleImageItem mReceivableClearingImageItemList;
    private CImageItem mPrePayableImageItem;// = new CMenuItem("璐棰浠绠＄");
    private CLittleImageItem mPrePayableImageItemList;
    private CImageItem mPayableClearingImageItem;// = new CMenuItem("浠娆剧绠绠＄");
    private CLittleImageItem mPayableClearingImageItemList;
    // warehouse
    private CImageItem wStorageInImageItem;
    private CLittleImageItem wStorageInImageItemList;
    private CImageItem wStorageOutImageItem;
    private CLittleImageItem wStorageOutImageItemList;
    private CImageItem wStorageOutflowImageItem;
    private CLittleImageItem wStorageOutflowImageItemList;
    private CImageItem wStorageLossImageItem;
    private CLittleImageItem wStorageLossImageItemList;
    private CImageItem wStorageCheckImageItem;
    private CLittleImageItem wStorageCheckImageItemList;
    private CImageItem wStorageMoveImageItem;
    private CLittleImageItem wStorageMoveImageItemList;
    private CImageItem wStorageChangeMoneyImageItem;
    private CLittleImageItem wStorageChangeMoneyImageItemList;
    private CImageItem wStorageMaxMinImageItem;
    private CLittleImageItem wStorageMaxMinImageItemList;
    // produce

    // system
    private CImageItem sCompanyInfoImageItem;
    private CImageItem sUserImageItem;
    private CImageItem sAccountOptionItem;
    private CImageItem sLogImageItem;
    private CImageItem sNumberImageItem;
    //report purchase
    private CImageItem rPurchaseIndentImageItem;
    private CImageItem rPurchaseIndentProStatImageItem;
    private CImageItem rPurchaseIndentProductImageItem;
    private CImageItem rPurchaseIndentBalanceImageItem;////跺
    private CImageItem rPurchaseIndentProBalStatImageItem;////跺
    private CImageItem rPurchaseIndentProBalDetailImageItem;////跺
    private CImageItem rPurchaseIndentSupplierStatImageItem;
    private CImageItem rPurchaseIndentPersonStatImageItem;
    private CImageItem rProductPurchaseStatImageItem;
    private CImageItem rProductPurchaseDetailImageItem;
    private CImageItem rSupplierPurchaseStatImageItem;
    private CImageItem rSupplierPurchaseDetailImageItem;
    private CImageItem rEmployeePurchaseStatImageItem;
    private CImageItem rEmployeePurchaseDetailImageItem;
    private CImageItem rProductPurchaseGatherImageItem;////跺
    private CImageItem rProductPurchasePriceWaveImageItem;////跺

    //report sale
    private CImageItem rSaleIndentImageItem;
    private CImageItem rSaleIndentProStatImageItem;
    private CImageItem rSaleIndentProductImageItem;
    private CImageItem rSaleIndentBalanceImageItem;////跺
    private CImageItem rSaleIndentProBalStatImageItem;////跺
    private CImageItem rSaleIndentProBalDetailImageItem;////跺
    private CImageItem rSaleIndentCustomerStatImageItem;
    private CImageItem rSaleIndentPersonStatImageItem;
    private CImageItem rCustomerMonthSaleCompareImageItem;
    private CImageItem rProductMonthSaleCompareImageItem;
    private CImageItem rCustomerSaleOrderImageItem;
    private CImageItem rProductSaleOrderImageItem;
    private CImageItem rEmployeeSaleOrderImageItem;
    private CImageItem rProductSaleStatImageItem;
    private CImageItem rProductSaleDetailImageItem;
    private CImageItem rSupplierSaleStatImageItem;
    private CImageItem rSupplierSaleDetailImageItem;
    private CImageItem rEmployeeSaleStatImageItem;
    private CImageItem rEmployeeSaleDetailImageItem;
    private CImageItem rProductSaleGatherImageItem;
    private CImageItem rProductPriceImageItem;
    private CImageItem rProductSalePriceWaveImageItem;

    //report finance
    private CImageItem rSubjectBalanceImageItem;
    private CImageItem rCashBankMonthReportImageItem;
    private CImageItem rCashBankDetailImageItem;
    private CImageItem rDailyFeeReportImageItem;
    private CImageItem rDailyFeeDetailImageItem;
    private CImageItem rOtherIncomeMonthReportImageItem;
    private CImageItem rOtherIncomeDetailImageItem;

    //report balance
    private CImageItem rSupplierPayBalanceImageItem;
    private CImageItem rSupplierUnbalanceDetailImageItem;
    private CImageItem rCustomerReceiveBalanceImageItem;
    private CImageItem rCustomerUnbalanceDetailImageItem;
    private CImageItem rSupplierQueryImageItem;////跺
    private CImageItem rCustomerQueryImageItem;////跺
    private JPanel basePanel;
    private JPanel initPanel;
    private JPanel storagePanel;
    private JPanel purchasePanel;
    private JPanel salesPanel;
    private JPanel clearingPanel;
    private JPanel bankCashPanel;
    private JPanel welcomePanel;
    private JPanel bPanel;
    //private CGridItemPane outStoragePanel;
    //private CGridItemPane checkStoragePanel;
    //private CGridItemPane moneyStoragePanel;
    private JPanel systemPanel;
    private JPanel reportPanel;
    private CBaseImageItem productBaseItem = new CBaseImageItem(new ImageIcon(this.getClass().getResource("/resources/png/items/24/product2.png")), "商品资料");
    private CBaseImageItem storageSearchBaseItem = new CBaseImageItem(new ImageIcon(this.getClass().getResource("/resources/png/items/24/search.png")), "库存查询");
    private CBaseImageItem storageMinMaxBaseItem = new CBaseImageItem(new ImageIcon(this.getClass().getResource("/resources/png/items/24/search.png")), "库存上下限");
    private CBaseImageItem payableBaseItem = new CBaseImageItem(new ImageIcon(this.getClass().getResource("/resources/png/items/24/search.png")), "供应商应付未结");
    private CBaseImageItem receivableBaseItem = new CBaseImageItem(new ImageIcon(this.getClass().getResource("/resources/png/items/24/search.png")), "客户应收未结");
    private CBaseImageItem employeeSaleBaseItem = new CBaseImageItem(new ImageIcon(this.getClass().getResource("/resources/png/items/24/employee.png")), "业务员业绩");
    private CBaseImageItem priceBaseItem = new CBaseImageItem(new ImageIcon(this.getClass().getResource("/resources/png/items/24/money.png")), "价格信息");
    private CBaseImageItem subjectRemainBaseItem = new CBaseImageItem(new ImageIcon(this.getClass().getResource("/resources/png/items/24/money.png")), "科目余额");
    private CBaseImageItem customerBaseItem = new CBaseImageItem(new ImageIcon(this.getClass().getResource("/resources/png/items/24/customer.png")), "客户资料");
    private CBaseImageItem storageBaseItem = new CBaseImageItem(new ImageIcon(this.getClass().getResource("/resources/png/items/24/storage.png")), "仓库资料");
    private CBaseImageItem subjectBaseItem = new CBaseImageItem(new ImageIcon(this.getClass().getResource("/resources/png/items/24/subject.png")), "会计科目");
    private CBaseImageItem refreshBaseInfo = new CBaseImageItem(new ImageIcon(this.getClass().getResource("/resources/refresh.png")), "刷新基础信息");
    private CBaseImageItem welcomePage = new CBaseImageItem(new ImageIcon(this.getClass().getResource("/resources/welcomeicon.png")), "欢迎页面");
    private CBaseImageItem changePassword = new CBaseImageItem(new ImageIcon(this.getClass().getResource("/resources/key.png")), "修改密码");
    private ImageIcon arrowDownIcon = new ImageIcon(this.getClass().getResource("/resources/png/items/arrows/down.png"));
    private ImageIcon arrowUpIcon = new ImageIcon(this.getClass().getResource("/resources/png/items/arrows/up.png"));
    private ImageIcon arrowLeftIcon = new ImageIcon(this.getClass().getResource("/resources/png/items/arrows/left.png"));
    private ImageIcon arrowRightIcon = new ImageIcon(this.getClass().getResource("/resources/png/items/arrows/right.png"));

    public void showAboutDialog() {
        JDialog dialog = new CAboutDialog(this);
        dialog.setVisible(true);
    }

    public void showDatabaseTool() {
        try {
            if (MessageBox.showQuestionDialog(this, "对数据库进行备份及恢复操作必须先退出当前系统，您确定要这么做吗?") == 0) {
//                String command = Main.getInstallPath() +"/databasetool.exe";
//                Runtime.getRuntime().exec(command);
//                System.exit(0);
                MessageBox.showMessageDialog(this, "当前版本暂未实现!");
            }

        } catch (Exception ex) {
            MessageBox.showMessageDialog(this, "系统没有正确安装，找不到数据库工具程序!");
        }
    }

    public void showHelpBook() {
        try {
            String helpFile = Main.getInstallPath() + "/help.chm";
            Runtime.getRuntime().exec("hh.exe " + helpFile);
        } catch (Exception ex) {
        }
    }

    public void showStorageAlertQueryDialog(Company company) {
        CStorageAlertQueryDialog dialog = new CStorageAlertQueryDialog(Main.getMainFrame(), company);
        dialog.setVisible(true);
    }

    public void showStorageAlertQueryDialog() {
        CStorageAlertQueryDialog dialog = new CStorageAlertQueryDialog(Main.getMainFrame());
        dialog.setVisible(true);
    }

    public void showStorageQueryWindow() {
        //this.clearInternalFrames();
        JFrame roleManageDialog = new CStorageQueryWindow("库存余额查询");
        roleManageDialog.setVisible(true);

    }

    public void showSubjectQueryWindow() {
        //this.clearInternalFrames();
        JFrame subjectQueryWindow = new CSubjectQueryWindow("科目余额查询");
        subjectQueryWindow.setVisible(true);
    }

    //*************************************************************************************
    public void showStorageInReportWindow() {
        //this.clearInternalFrames();
        JFrame roleManageDialog = new CStorageInReportWindow("库存商品入库查询");
        roleManageDialog.setVisible(true);

    }

    public void showStorageOutReportWindow() {
        //this.clearInternalFrames();
        JFrame window = new CStorageOutReportWindow("库存商品出库查询");
        window.setVisible(true);

    }
  public void showSaleReportWindow() {
        //this.clearInternalFrames();

//        JFrame window = new CReportWindow("销售查询");
       // window.setVisible(true);
    }
    public void showStorageInListQueryWindow() {
        //this.clearInternalFrames();
        JFrame window = new CStorageInListQueryWindow("库存商品入库明细查询");
        window.setVisible(true);
    }

    public void showStorageOutListQueryWindow() {
        //this.clearInternalFrames();
        JFrame window = new CStorageOutListQueryWindow("库存商品出库明细查询");

        //this.desktopPane.add(window, -1);
        window.setVisible(true);
    }

    public void showStorageMinMaxQueryWindow() {
        //this.clearInternalFrames();
        JFrame window = new CStorageMinMaxQueryWindow("库存商品上下限查询");
        window.setVisible(true);

    }

    public void showStorageOutflowReportWindow() {
        //this.clearInternalFrames();
        JFrame window = new CStorageOutflowReportWindow("库存报溢明细查询");
        window.setVisible(true);


    }

    public void showStorageCheckReportWindow() {
        //this.clearInternalFrames();
        JFrame window = new CStorageCheckReportWindow("库存盘点明细查询");

        //this.desktopPane.add(window, -1);
        window.setVisible(true);
    }

    public void showStorageChangeMoneyReportWindow() {
        //this.clearInternalFrames();
        JFrame window = new CStorageChangeMoneyReportWindow("库存变价明细查询");
        window.setVisible(true);
    }

    public void showStorageLossReportWindow() {
        //this.clearInternalFrames();
        JFrame window = new CStorageLossReportWindow("库存报损明细查询");
        window.setVisible(true);
    }

    public void showStorageCheckQueryWindow() {
        //this.clearInternalFrames();
        JFrame window = new CStorageCheckQueryWindow("库存报盘点查询");

        window.setVisible(true);
    }

    public void showStorageMoveReportWindow() {
        //this.clearInternalFrames();
        JFrame window = new CStorageMoveReportWindow("库存移库明细查询");
        window.setVisible(true);
    }

    //show purchase report window
    public void showPurchaseIndentQueryWindow() {
        //this.clearInternalFrames();
        JFrame window = new CPurchaseIndentQueryWindow("采购订单查询");
        window.setVisible(true);
    }

    public void showEmployeePurchaseDetailQueryWindow() {
        //this.clearInternalFrames();
        JFrame window = new CEmployeePurchaseDetailQueryWindow("职员采购明细查询");
        window.setVisible(true);
    }

    public void showEmployeePurchaseStatReportWindow() {
        //this.clearInternalFrames();
        JFrame window = new CEmployeePurchaseStatReportWindow("职员采购统计表");
        window.setVisible(true);
    }

    public void showProductPurchaseDetailQueryWindow() {
        //this.clearInternalFrames();
        JFrame window = new CProductPurchaseDetailQueryWindow("商品采购明细查询");
        //this.desktopPane.add(window, -1);
        window.setVisible(true);
    }

    public void showProductPurchaseGatherReportWindow() {
        //this.clearInternalFrames();
        JFrame window = new CProductPurchaseGatherReportWindow("商品采购汇总表");
        window.setVisible(true);
    }

    public void showProductPurchasePriceWaveReportWindow() {
        //this.clearInternalFrames();
        JFrame window = new CProductPurchasePriceWaveReportWindow("商品采购价格波动表");
        window.setVisible(true);
    }

    public void showProductPurchaseStatReportWindow() {
        //this.clearInternalFrames();
        JFrame window = new CProductPurchaseStatReportWindow("商品采购统计表");
        window.setVisible(true);
    }

    public void showPurchaseIndentBalanceQueryWindow() {
        //this.clearInternalFrames();
        JFrame window = new CPurchaseIndentBalanceQueryWindow("采购订单余额查询");
        window.setVisible(true);
    }

    public void showPurchaseIndentPersonStatWindow() {
        //this.clearInternalFrames();
        JFrame window = new CPurchaseIndentPersonStatWindow("采购订单业务员统计");
        window.setVisible(true);
    }

    public void showPurchaseIndentProBalDetailWindow() {
        //this.clearInternalFrames();
        JFrame window = new CPurchaseIndentProBalDetailWindow("采购订单商品余额明细查询");
        window.setVisible(true);
    }

    public void showPurchaseIndentProBalStatWindow() {
        //this.clearInternalFrames();
        JFrame window = new CPurchaseIndentProBalStatWindow("采购订单商品余额统计");
        window.setVisible(true);
    }

    public void showPurchaseIndentProductQueryWindow() {
        //this.clearInternalFrames();
        JFrame window = new CPurchaseIndentProductQueryWindow("采购订单商品明细");
        window.setVisible(true);
    }

    public void showPurchaseIndentProductStatWindow() {
        //this.clearInternalFrames();
        JFrame window = new CPurchaseIndentProductStatWindow("采购订单商品统计");
        window.setVisible(true);
    }

    public void showPurchaseIndentSupplierStatWindow() {
        //this.clearInternalFrames();
        JFrame window = new CPurchaseIndentSupplierStatWindow("采购订单供应商统计");
        window.setVisible(true);
    }

    public void showSupplierPurchaseDetailQueryWindow() {
        //this.clearInternalFrames();
        JFrame window = new CSupplierPurchaseDetailQueryWindow("供应商采购明细查询");
        window.setVisible(true);
    }

    public void showSupplierPurchaseStatReportWindow() {
        //this.clearInternalFrames();
        JFrame window = new CSupplierPurchaseStatReportWindow("供应商采购统计表");
        window.setVisible(true);
    }

    public void showSaleIndentQueryWindow() {
        //this.clearInternalFrames();
        JFrame window = new CSaleIndentQueryWindow("销售订单查询");
        window.setVisible(true);
    }

    public void showSaleIndentProductStatWindow() {
        //this.clearInternalFrames();
        JFrame window = new CSaleIndentProductStatWindow("销售订单商品统计");
        window.setVisible(true);
    }

    public void showSaleIndentProductQueryWindow() {
        //this.clearInternalFrames();
        JFrame window = new CSaleIndentProductQueryWindow("销售订单商品明细");
        window.setVisible(true);
    }

    public void showSaleIndentBalanceQueryWindow() {
        //this.clearInternalFrames();
        JFrame window = new CSaleIndentBalanceQueryWindow("销售订单余额查询");
        window.setVisible(true);
    }

    public void showSaleIndentProBalStatWindow() {
        //this.clearInternalFrames();
        JFrame window = new CSaleIndentProBalStatWindow("销售订单商品余额统计");
        window.setVisible(true);
    }

    public void showSaleIndentProBalDetailWindow() {
        //this.clearInternalFrames();
        JFrame window = new CSaleIndentProBalDetailWindow("销售订单商品余额明细查询");
        window.setVisible(true);
    }

    public void showSaleIndentCustomerStatWindow() {
        //this.clearInternalFrames();
        JFrame window = new CSaleIndentCustomerStatWindow(" 客商统计");
        window.setVisible(true);
    }

    public void showSaleIndentPersonStatWindow() {
        //this.clearInternalFrames();
        JFrame window = new CSaleIndentPersonStatWindow("销售订单业务员统计");
        window.setVisible(true);
    }

    public void showCustomerMonthSaleCompareWindow() {
        //this.clearInternalFrames();
        JFrame window = new CCustomerMonthSaleCompareWindow("客商月销售比较表");
        window.setVisible(true);
    }

    public void showProductMonthSaleCompareWindow() {
        //this.clearInternalFrames();
        JFrame window = new CProductMonthSaleCompareWindow("商品月销售比较表");
        window.setVisible(true);
    }

    public void showCustomerSaleOrderWindow() {
        //this.clearInternalFrames();
        JFrame window = new CCustomerSaleOrderWindow("客商销售排行榜");
        //this.desktopPane.add(window, -1);
        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showProductSaleOrderWindow() {
        //this.clearInternalFrames();
        JFrame window = new CProductSaleOrderWindow("商品销售排行榜");
        //this.desktopPane.add(window, -1);
        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showEmployeeSaleOrderWindow() {
        //this.clearInternalFrames();
        JFrame window = new CEmployeeSaleOrderWindow("职员销售排行榜");
        //this.desktopPane.add(window, -1);
        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showProductSaleStatWindow() {
        //this.clearInternalFrames();
        JFrame window = new CProductSaleStatReportWindow("商品销售统计表");
        //this.desktopPane.add(window, -1);
        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showProductSaleDetailWindow() {
        //this.clearInternalFrames();
        JFrame window = new CProductSaleDetailQueryWindow("商品销售明细查询");
        //this.desktopPane.add(window, -1);
        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showCustomerSaleStatWindow() {
        //this.clearInternalFrames();
        JFrame window = new CCustomerSaleStatReportWindow("客商销售统计表");
        //this.desktopPane.add(window, -1);
        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showCustomerSaleDetailWindow() {
        //this.clearInternalFrames();
        JFrame window = new CCustomerSaleDetailQueryWindow("客商销售明细查询");
        //this.desktopPane.add(window, -1);
        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showEmployeeSaleStatWindow() {
        //this.clearInternalFrames();
        JFrame window = new CEmployeeSaleStatReportWindow("职员销售统计表");
        //this.desktopPane.add(window, -1);
        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showEmployeeSaleDetailWindow() {
        //this.clearInternalFrames();
        JFrame window = new CEmployeeSaleDetailQueryWindow("职员销售明细查询");
        //this.desktopPane.add(window, -1);
        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showProductSaleGatherWindow() {
        //this.clearInternalFrames();
        JFrame window = new CProductSaleGatherReportWindow("商品销售汇总表");
        //this.desktopPane.add(window, -1);
        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showProductPriceQueryWindow() {
        //this.clearInternalFrames();
        JFrame window = new CProductPriceQueryWindow("商品价格查询");
        //this.desktopPane.add(window, -1);
        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showProductSalePriceWaveWindow() {
        //this.clearInternalFrames();
        JFrame window = new CProductSalePriceWaveReportWindow("商品销售价格波动表");
        //this.desktopPane.add(window, -1);
        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showCashBankMonthReportWindow() {
        //this.clearInternalFrames();
        JFrame window = new CCashBankMonthReportWindow("现金银行月报表");
        //this.desktopPane.add(window, -1);
        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showCashBankDetailQueryWindow() {
        //this.clearInternalFrames();
        JFrame window = new CCashBankDetailQueryWindow("现金银行明细查询");
        //this.desktopPane.add(window, -1);
        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showDailyFeeReportWindow() {
        //this.clearInternalFrames();
        JFrame window = new CDailyFeeReportWindow("日常费用报表");
        //this.desktopPane.add(window, -1);
        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showDailyFeeDetailQueryWindow() {
        //this.clearInternalFrames();
        JFrame window = new CDailyFeeDetailQueryWindow("日常费用明细查询");
        //this.desktopPane.add(window, -1);
        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showOtherIncomeMonthReportWindow() {
        //this.clearInternalFrames();
        JFrame window = new COtherIncomeMonthReportWindow("其它收入月报表");
        //this.desktopPane.add(window, -1);
        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showOtherIncomeDetailQueryWindow() {
        //this.clearInternalFrames();
        JFrame window = new COtherIncomeDetailQueryWindow("其它收入明细查询");
        //this.desktopPane.add(window, -1);
        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showSupplierPayBalanceQueryWindow() {
        //this.clearInternalFrames();
        JFrame window = new CSupplierPayBalanceQueryWindow("供应商应付余额查询");
        //this.desktopPane.add(window, -1);
        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showSupplierUnbalanceDetailQueryWindow() {
        //this.clearInternalFrames();
        JFrame window = new CSupplierUnbalanceDetailQueryWindow("供应商未结明细查询");
        //this.desktopPane.add(window, -1);
        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showCustomerReceiveBalanceQueryWindow() {
        //this.clearInternalFrames();
        JFrame window = new CCustomerReceiveBalanceQueryWindow("客商应收余额查询");
        //this.desktopPane.add(window, -1);
        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showCustomerUnbalanceDetailQueryWindow() {
        //this.clearInternalFrames();
        JFrame window = new CCustomerUnbalanceDetailQueryWindow("客商未结明细查询");
        //this.desktopPane.add(window, -1);
        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showSupplierQueryWindow() {
        //this.clearInternalFrames();
        JFrame window = new CSupplierQueryWindow("供应商往来流水查询");
        //this.desktopPane.add(window, -1);
        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showCustomerQueryWindow() {
        //this.clearInternalFrames();
        JFrame window = new CCustomerQueryWindow("客商往来流水查询");
        //this.desktopPane.add(window, -1);
        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showCustomerContactsReportDialog() {
    }

    public void showRoleManageDialog() {
        //this.clearInternalFrames();
        JFrame roleManageDialog = new CRoleManageWindow("角色管理");

        //this.desktopPane.add(roleManageDialog, -1);

        try {
            roleManageDialog.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showUserManageWindow() {
        //this.clearInternalFrames();
        JFrame window = new CUserManageWindow("用户管理");
        //this.desktopPane.add(window, -1);
        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showChangePasswordDialog() {
        JDialog dialog = new CChangePasswordDialog(this);
        dialog.setVisible(true);
    }

    public void showCSystemLogWindow() {
        //this.clearInternalFrames();
        JFrame window = new CSystemLogWindow("系统日志");
        //this.desktopPane.add(window, -1);
        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showBeginPaymentManageWindow() {
        //this.clearInternalFrames();
        JFrame window = new CBeginPaymentWindow("应付期初");
        //this.desktopPane.add(window, -1);
        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showSystemLogDialog() {
        JDialog dialog = new CSystemLogDialog(this);
        dialog.setVisible(true);
    }

    public void showSystemOptionDialog() {
        JDialog dialog = new CSystemOptionDialog(this);
        dialog.setVisible(true);
    }

    public void showNumberManageDialog() {
        JDialog dialog = new CSystemOptionDialog(this);
        dialog.setVisible(true);
    }

    public void showCompanyInfoDialog() {
        JDialog dialog = new CCompanyInfoDialog(this);
        dialog.setVisible(true);
    }
    //liufei

    public void showCProUnitListDialog() {
//        this.formDialog = new CProUnitListDialog(Main.getMainFrame());
//        this.formDialog.setVisible(true);
    }

    public void showCProShelfListDialog() {
//        this.formDialog = new CProShelfListDialog(Main.getMainFrame());
//        this.formDialog.setVisible(true);
    }

    public void showCProTaxrateListDialog() {
//        this.formDialog = new CProTaxrateListDialog(Main.getMainFrame());
//        this.formDialog.setVisible(true);
    }

    public void showCCusTypeListDialog() {
//        this.formDialog = new CCusTypeListDialog(Main.getMainFrame());
//        this.formDialog.setVisible(true);
    }

    public void showCCusPriceListDialog() {
//        this.formDialog = new CCusPriceListDialog(Main.getMainFrame());
//        this.formDialog.setVisible(true);
    }

    public void showCCusInvoiceListDialog() {
//        this.formDialog = new CCusInvoiceListDialog(Main.getMainFrame());
//        this.formDialog.setVisible(true);
    }

    public void showCEmpDutyListDialog() {
//        this.formDialog = new CEmpDutyListDialog(Main.getMainFrame());
//        this.formDialog.setVisible(true);
    }

    public void showCEmpDegreeListDialog() {
//        this.formDialog = new CEmpDegreeListDialog(Main.getMainFrame());
//        this.formDialog.setVisible(true);
    }

    public void showCEmpLevelListDialog() {
//        this.formDialog = new CEmpLevelListDialog(Main.getMainFrame());
//        this.formDialog.setVisible(true);
    }

    public void showCEmpHealthListDialog() {
//        this.formDialog = new CEmpHealthListDialog(Main.getMainFrame());
//        this.formDialog.setVisible(true);
    }

    public void showCStoTypeListDialog() {
//        this.formDialog = new CStoTypeListDialog(Main.getMainFrame());
//        this.formDialog.setVisible(true);
    }

    public void showProductManageWindow() {
        //this.clearInternalFrames();
        JFrame productManageWindow = new CProductManageWindow("商品信息");
        //this.desktopPane.add(productManageWindow, new Integer(1));

//        if (productManageWindow.getParent() != //this.desktopPane) {
//            //this.desktopPane.add(productManageWindow, -1);
//        }

        try {
            productManageWindow.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showCustomerManageWindow() {
        //this.clearInternalFrames();
        JFrame customerManageWindow = new CCustomerManageWindow("客户信息");

        //this.desktopPane.add(customerManageWindow, -1);

        try {
            customerManageWindow.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showSubjectManageWindow() {
        //this.clearInternalFrames();
        JFrame subjectManageWindow = new CSubjectManageWindow("会计科目");
        //this.desktopPane.add(subjectManageWindow, new Integer(1));

//        if (subjectManageWindow.getParent() != //this.desktopPane) {
//            //this.desktopPane.add(subjectManageWindow, -1);
//        }

        try {
            subjectManageWindow.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showEmployeeWindow() {
        //this.clearInternalFrames();
        JFrame employeeManageWindow = new CEmployeeManageWindow("员工信息");

        //this.desktopPane.add(employeeManageWindow, -1);
        try {
            employeeManageWindow.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showStorageManageWindow() {
        //this.clearInternalFrames();
        JFrame storageManageWindow = new CStorageManageWindow("仓库信息");

        //this.desktopPane.add(storageManageWindow, -1);

        try {
            storageManageWindow.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showStorageInWindow() {
        //this.clearInternalFrames();
        JFrame storageInWindow = new CStorageInWindow("商品入库");

        //this.desktopPane.add(storageInWindow, -1);

        try {
            storageInWindow.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showStorageOutflowWindow() {
        //this.clearInternalFrames();
        JFrame window = new CStorageOutflowWindow("库存报溢");

        //this.desktopPane.add(window, -1);

        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showStorageOutflowQueryWindow() {
        //this.clearInternalFrames();
        JFrame window = new CStorageOutflowQueryWindow("库存报溢");
        //this.desktopPane.add(window, -1);

        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showStorageLossQueryWindow() {
        //this.clearInternalFrames();
        JFrame window = new CStorageLossQueryWindow("库存报损");
        //this.desktopPane.add(window, -1);

        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showStorageMoveQueryWindow() {
        //this.clearInternalFrames();
        JFrame window = new CStorageMoveQueryWindow("库存移库");
        //this.desktopPane.add(window, -1);

        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showStorageLossWindow() {
        //this.clearInternalFrames();
        JFrame window = new CStorageLossWindow("库存报损");

        //this.desktopPane.add(window, -1);

        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showStorageMoveWindow() {
        //this.clearInternalFrames();
        JFrame window = new CStorageMoveWindow("移库管理");

        //this.desktopPane.add(window, -1);

        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showStorageOutWindow() {
        //this.clearInternalFrames();
        JFrame storageOutWindow = new CStorageOutWindow("商品出库");

        //this.desktopPane.add(storageOutWindow, -1);

        try {
            storageOutWindow.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showStorageCheckWindow() {
        //this.clearInternalFrames();
        JFrame window = new CStorageCheckWindow("盘点管理");

        //this.desktopPane.add(window, -1);
        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showStorageChangeMoneyWindow() {
        //this.clearInternalFrames();
        JFrame window = new CStorageChangeMoneyWindow("库存变价");

        //this.desktopPane.add(window, -1);

        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showStorageMaxMinWindow() {
        //this.clearInternalFrames();
        JFrame window = new CStorageMinMaxWindow("库存上下限");

        //this.desktopPane.add(window, -1);

        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showSaleQuoteWindow() {
        //this.clearInternalFrames();
        JFrame window = new CSaleQuoteWindow("商品报价");

        //this.desktopPane.add(window, -1);

        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showSaleOrderWindow() {
        //this.clearInternalFrames();
        JFrame window = new CSaleOrderWindow("销售订单");

        //this.desktopPane.add(window, -1);

        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showSaleDetailWindow() {
        //this.clearInternalFrames();
        JFrame window = new CSaleDetailWindow("销售单");

        //this.desktopPane.add(window, -1);

        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showSaleGarcheringWindow() {
        //this.clearInternalFrames();
        JFrame window = new CSaleGartheringWindow("收款结算");

        //this.desktopPane.add(window, -1);

        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showSaleChangeMoneyWindow() {
        //this.clearInternalFrames();
        JFrame window = new CSaleChangeMoneyWindow("商品调价");

        //this.desktopPane.add(window, -1);

        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showSaleOrderChangeWindow() {
        //this.clearInternalFrames();

        JFrame window = new CSaleChangeOrderWindow("订单变更");

        //this.desktopPane.add(window, -1);

        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showSaleOrderBackWindow() {
        //this.clearInternalFrames();
        JFrame window = new CSaleOrderBackWindow("销售退货");

        //this.desktopPane.add(window, -1);

        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showPurchaseOrderWindow() {
        //this.clearInternalFrames();
        JFrame window = new CPurchaseIndentWindow("采购订单");

        //this.desktopPane.add(window, -1);

        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showPurchaseDetailWindow() {
        //this.clearInternalFrames();
        JFrame window = new CPurchaseOrderWindow("采购单");

        //this.desktopPane.add(window, -1);

        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showPurchasePaymentWindow() {
        //this.clearInternalFrames();
        JFrame window = new CPayableClearingManageWindow("付款结算");

        //this.desktopPane.add(window, -1);

        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showPurchaseChangeOrderWindow() {
        //this.clearInternalFrames();
        JFrame window = new CPurchaseChangeOrderWindow("采购订单变更");

        //this.desktopPane.add(window, -1);

        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showPurchaseOrderBackWindow() {
        //this.clearInternalFrames();
        JFrame window = new CPurchaseOrderBackWindow("采购退货");

        //this.desktopPane.add(window, -1);

        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showBeginStorageManageWindow() {
        //this.clearInternalFrames();
        JFrame window = new CBeginStorageWindow("库存期初");

        //this.desktopPane.add(window, -1);

        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showBeginSubjectManageWindow() {
        //this.clearInternalFrames();
        JFrame window = new CBeginSubjectWindow("科目余额期初");

        //this.desktopPane.add(window, -1);

        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showBeginReceiveableManageWindow() {
        //this.clearInternalFrames();
        JFrame window = new CBeginReceivableWindow("应收期初");

        //this.desktopPane.add(window, -1);

        try {
            window.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showBussinessExpenseManageWindow() {
        //this.clearInternalFrames();
        JFrame manageWindow = new CBussinessExpenseManageWindow("经营费用");
        //this.desktopPane.add(manageWindow, new Integer(1));



        try {
            manageWindow.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showCommonExpenseManageWindow() {
        //this.clearInternalFrames();
        JFrame manageWindow = new CCommonExpenseManageWindow("一般费用");
        //this.desktopPane.add(manageWindow, new Integer(1));



        try {
            manageWindow.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showOtherIncomeManageWindow() {
        //this.clearInternalFrames();
        JFrame manageWindow = new COtherIncomeManageWindow("其它收入");
        //this.desktopPane.add(manageWindow, new Integer(1));



        try {
            manageWindow.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showPayableClearingManageWindow() {
        //this.clearInternalFrames();
        JFrame manageWindow = new CPayableClearingManageWindow("付款结算");
        //this.desktopPane.add(manageWindow, new Integer(1));



        try {
            manageWindow.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showPrepayableManageWindow() {
        //this.clearInternalFrames();
        JFrame manageWindow = new CPrePayableManageWindow("采购预付");
        //this.desktopPane.add(manageWindow, new Integer(1));



        try {
            manageWindow.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showPrereceivableManageWindow() {
        //this.clearInternalFrames();
        JFrame manageWindow = new CPreReceivableManageWindow("销售预收");
        //this.desktopPane.add(manageWindow, new Integer(1));



        try {
            manageWindow.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void showReceivableClearingManageWindow() {
        //this.clearInternalFrames();
        JFrame manageWindow = new CReceivableClearingManageWindow("收款结算");
        //this.desktopPane.add(manageWindow, new Integer(1));



        try {
            manageWindow.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    public void refreshDataBase() {
        if (this.dataBaseObjectPool != null) {
            this.dataBaseObjectPool.dispose();
        }
        this.dataBaseObjectPool = new ObjectsPool(this.company);
        //refresh
        if (this.productSelectPanel != null) {
            this.productSelectPanel.refresh();
        }
    }

    public void showBankCashManageWindow() {
        //this.clearInternalFrames();
        JFrame manageWindow = new CBankCashManageWindow("现金银行");
        //this.desktopPane.add(manageWindow, new Integer(1));



        try {
            manageWindow.setVisible(true);

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

    private void close() {
        if (MessageBox.showQuestionDialog(MainFrame.this, "您确定要退出吗？") == 0) {
            Main.getSystemConfig().saveSystemConfig();
            System.exit(0);
        }
    }

    public void setDataBaseObjectPool(ObjectsPool dataBaseObjectPool) {
        this.dataBaseObjectPool = dataBaseObjectPool;
    }

    public CComboBoxPane getProductSelectPanel() {
//        if (this.productSelectPanel == null)
//        {
//            this.productSelectPanel = new ProductSelectPanel(this.company);
//        }
//        return this.productSelectPanel;
        return new ProductSelectPanel(this.company);
    }

    public ObjectsPool getObjectsPool() {
        if (this.listObjectPool == null) {
            this.listObjectPool = new ObjectsPool(this.company);
        }
        return this.listObjectPool;
    }

    public ObjectsPool getDataBaseObjectPool() {
        if (dataBaseObjectPool == null) {
            dataBaseObjectPool = new ObjectsPool(this.company);
        }
        return dataBaseObjectPool;
    }

    public Rectangle getClientRect() {
        return this.getBounds();
    }

    public void checkRegInfo() {
        if (company.getId() == 1001) {
            return;
        }
        if (this.generateCDKey(company.getName()).equals(company.getCdKey())) {
            return;
        }
        Date createDate = company.getCreateDate();
        Date nowDate = new Date();
        if (createDate.after(nowDate)) {
            company.setCreateDate(nowDate);
            Main.getServiceManager().getCompanyService().saveCompany(company);
        }
        Date tempDate = DateUtilities.caculateDate(createDate, 90);
        if (tempDate.before(nowDate)) {
            CRegForm rF = new CRegForm(this);
            rF.setVisible(true);
        }
    }

    public String generateCDKey(String companyName) {
        final String adjustCode = "thereisapigheadintheworld!";
        if (companyName.length() < 4) {
            return null;
        }
        String text = "";
        for (int i = 0; i < companyName.length(); i++) {
            int v = companyName.charAt(i);
            if (v > 128) {
                text += String.valueOf(v % 100);
            } else {
                text += String.valueOf(v);
            }
        }
        int l = text.length();
        if (l < 20) {
            text += "andshelovedmonkeykingbutthekingdoesntloveher";
        } else if (l > 20) {
            text = text.substring(l - 20);
        }
        String cdKeyString = "";
        int i = 0;
        while (cdKeyString.length() < 19) {
            int temp = text.charAt(i) + adjustCode.charAt(i);
            char a = (char) (temp % 25 + 'A');
            cdKeyString += a;
            if ((i + 1) % 4 == 0 && cdKeyString.length() < 19) {
                cdKeyString += "-";
            }
            i++;
        }
        return cdKeyString;
    }
    private IDbSupport storageDbSupport;
    private IDbSupport purchaseDbSupport;
    private IDbSupport saleDbSupport;
    private IDbSupport financeDbSupport;

    public IDbSupport getStorageDbSupport() {
        if (storageDbSupport == null) {
            storageDbSupport = new IDbSupport() {

                public void delete(Object obj) {

                    IStorageService service = Main.getServiceManager().getStorageService();
                    if (obj instanceof InStoragePo) {
                        service.deleteInStorageForm((InStoragePo) obj);
                    } else if (obj instanceof CheckStoragePo) {
                        service.deleteCheckStorageForm((CheckStoragePo) obj);
                    } else if (obj instanceof OutStoragePo) {
                        service.deleteOutStorageForm((OutStoragePo) obj);
                    } else if (obj instanceof InitialStoragePo) {
                        service.deleteInitialStorageForm((InitialStoragePo) obj);
                    } else if (obj instanceof LossStoragePo) {
                        service.deleteLossStorageForm((LossStoragePo) obj);
                    } else if (obj instanceof MinMaxStoragePo) {
                        service.deleteMinMaxStorageForm((MinMaxStoragePo) obj);
                    } else if (obj instanceof MoveStoragePo) {
                        service.deleteMoveStorageForm((MoveStoragePo) obj);
                    } else if (obj instanceof PriceStoragePo) {
                        service.deletePriceStorageForm((PriceStoragePo) obj);
                    } else if (obj instanceof OutflowStoragePo) {
                        service.deleteOutflowStorageForm((OutflowStoragePo) obj);
                    }
                }

                public void deleteAll(Collection<Object> objs) {
                }

                public void save(Object obj) {

                    IStorageService service = Main.getServiceManager().getStorageService();
                    if (obj instanceof InStoragePo) {
                        service.saveInStorageForm((InStoragePo) obj);
                    } else if (obj instanceof CheckStoragePo) {
                        service.saveCheckStorageForm((CheckStoragePo) obj);
                    } else if (obj instanceof OutStoragePo) {
                        service.saveOutStorageForm((OutStoragePo) obj);
                    } else if (obj instanceof InitialStoragePo) {
                        service.saveInitialStorageForm((InitialStoragePo) obj);
                    } else if (obj instanceof LossStoragePo) {
                        service.saveLossStorageForm((LossStoragePo) obj);
                    } else if (obj instanceof MinMaxStoragePo) {
                        service.saveMinMaxStorageForm((MinMaxStoragePo) obj);
                    } else if (obj instanceof MoveStoragePo) {
                        service.saveMoveStorageForm((MoveStoragePo) obj);
                    } else if (obj instanceof PriceStoragePo) {
                        service.savePriceStorageForm((PriceStoragePo) obj);
                    } else if (obj instanceof OutflowStoragePo) {
                        service.saveOutflowStorageForm((OutflowStoragePo) obj);
                    }

                }

                public void saveAll(Collection<Object> objs) {
                }
            };
        }
        return storageDbSupport;
    }

    public void addOrderChangedForm() {
//    dataSource =new dataSource();d
        table = new JDataTable();
        table.addMouseListener(new MouseListener() {

            public void mouseClicked(MouseEvent e) {
                // TODO Auto-generated method stub
                if (e.getClickCount() >= 2) {
//					doEdit();
                }
            }

            public void mouseEntered(MouseEvent e) {
                // TODO Auto-generated method stub
            }

            public void mouseExited(MouseEvent e) {
                // TODO Auto-generated method stub
            }

            public void mousePressed(MouseEvent e) {
                int mods = e.getModifiers();
                if ((mods & InputEvent.BUTTON3_MASK) != 0) {
                    mainPopMenu.show((Component) e.getSource(), e.getX(), e.getY());
                }
            }

            public void mouseReleased(MouseEvent e) {
                // TODO Auto-generated method stub
            }
        });
        table.addKeyListener(new KeyAdapter() {

            public void keyPressed(KeyEvent evt) {
                if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
                    doEdit();
                }
            }

            private void doEdit() {
                throw new UnsupportedOperationException("Not yet implemented");
            }
        });
        this.dataSource = this.table.getDataSource();
        this.dataSource.setKeyColumnName("id");

        CChoosepurchaseOrderChangeDialog dialog = new CChoosepurchaseOrderChangeDialog(this, dataSource, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);

    }

    public void addSaleOrderChangedForm() {
//    dataSource =new dataSource();d
        table = new JDataTable();
        table.addMouseListener(new MouseListener() {

            public void mouseClicked(MouseEvent e) {
                // TODO Auto-generated method stub
                if (e.getClickCount() >= 2) {
//					doEdit();
                }
            }

            public void mouseEntered(MouseEvent e) {
                // TODO Auto-generated method stub
            }

            public void mouseExited(MouseEvent e) {
                // TODO Auto-generated method stub
            }

            public void mousePressed(MouseEvent e) {
                int mods = e.getModifiers();
                if ((mods & InputEvent.BUTTON3_MASK) != 0) {
                    mainPopMenu.show((Component) e.getSource(), e.getX(), e.getY());
                }
            }

            public void mouseReleased(MouseEvent e) {
                // TODO Auto-generated method stub
            }
        });
        table.addKeyListener(new KeyAdapter() {

            public void keyPressed(KeyEvent evt) {
                if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
                    doEdit();
                }
            }

            private void doEdit() {
                throw new UnsupportedOperationException("Not yet implemented");
            }
        });
        this.dataSource = this.table.getDataSource();
        this.dataSource.setKeyColumnName("id");

        CSaleChooseOrderChangeDialog dialog = new CSaleChooseOrderChangeDialog(this, dataSource, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);

    }

    public void addStorageInForm() {
        CStorageInDialog dialog = new CStorageInDialog(this, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);
    }

    public void addStorageOutForm() {
        CStorageOutDialog dialog = new CStorageOutDialog(this, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);
    }

    public void addOutflowForm() {
        CStorageOutflowDialog dialog = new CStorageOutflowDialog(this, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);
    }

    public void addStorageMoveForm() {
        CStorageMoveDialog dialog = new CStorageMoveDialog(this, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);

    }

    public void addStorageCheckForm() {
        CStorageCheckDialog dialog = new CStorageCheckDialog(this, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);
    }

    public void addStorageChangeMoneyForm() {
        CStorageChangeMoneyDialog dialog = new CStorageChangeMoneyDialog(this, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);
    }

    public void addSaleQuoteForm() {
        CSaleQuoteDialog dialog = new CSaleQuoteDialog(this, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);
    }

    public void addSaleDetailForm() {
        CSaleDetailDialog dialog = new CSaleDetailDialog(this, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);
    }

    public void addSaleChangeMoneyForm() {
        CSaleChangeMoneyDialog dialog = new CSaleChangeMoneyDialog(this, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);
    }

    public void addSaleOrderBackForm() {
        CSaleOrderBackDialog dialog = new CSaleOrderBackDialog(this, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);
    }

    public void addSaleOrderForm() {
        CSaleOrderDialog dialog = new CSaleOrderDialog(this, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);

    }

    public void addPurchaseOrderForm() {
        CPurchaseIndentDialog dialog = new CPurchaseIndentDialog(this, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);
    }

    public void addPurchaseDetailForm() {
        CPurchaseOrderDialog dialog = new CPurchaseOrderDialog(this, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);

    }

    public void addPurchasePaymentForm() {
        CPayableClearingDialog dialog = new CPayableClearingDialog(this, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);
    }

    public void addPurchaseOrderBackForm() {

        CPurchaseOrderBackDialog dialog = new CPurchaseOrderBackDialog(this, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);
    }

    public void addPrereceivableForm() {
        CPreReceivableDialog dialog = new CPreReceivableDialog(this, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);
    }

    public void addReceivableClearingForm() {
        CReceivableClearingDialog dialog = new CReceivableClearingDialog(this, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);
    }

    public void addPrepayableForm() {
        CPrePayableDialog dialog = new CPrePayableDialog(this, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);
    }

    public void addPayableClearingForm() {
        CPayableClearingDialog dialog = new CPayableClearingDialog(this, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);
    }

    public void addBussinessExpenseForm() {
        CBussinessExpenseDialog dialog = new CBussinessExpenseDialog(this, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);
    }

    public void addCommonExpenseForm() {
        CCommonExpenseDialog dialog = new CCommonExpenseDialog(this, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);
    }

    public void addOtherIncomeForm() {
        COtherIncomeDialog dialog = new COtherIncomeDialog(this, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);
    }

    public void addBankCashForm() {
        CBankCashDialog dialog = new CBankCashDialog(this, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);
    }

    public void addBeginStorageForm() {
        CBeginStorageDialog dialog = new CBeginStorageDialog(this, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);
    }

    public void addBeginSubjectForm() {
        CBeginSubjectDialog dialog = new CBeginSubjectDialog(this, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);
    }

    public void addBeginReceiveableForm() {
        CBeginReceivableDialog dialog = new CBeginReceivableDialog(this, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);
    }

    public void addBeginPaymentForm() {
        CBeginPaymentDialog dialog = new CBeginPaymentDialog(this, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);
    }

    public void addStorageLossForm() {
        CStorageLossDialog dialog = new CStorageLossDialog(this, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);
    }

    public void addStorageMaxMinForm() {
        CStorageMinMaxDialog dialog = new CStorageMinMaxDialog(this, getStorageDbSupport());
        dialog.newDataRow();
        dialog.setVisible(true);
    }
}
